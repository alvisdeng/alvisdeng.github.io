<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Introduction to Pandas | 阿平的自我修养</title><meta name="keywords" content="Data"><meta name="author" content="阿平"><meta name="copyright" content="阿平"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="Pandas is a software library written for the Python programming language for data manipulation and analysis. In particular, it offers data structures and operations for manipulating numerical tables a">
<meta property="og:type" content="article">
<meta property="og:title" content="Introduction to Pandas">
<meta property="og:url" content="https://www.facequant.com/2020/08/18/Introduction-to-Pandas/index.html">
<meta property="og:site_name" content="阿平的自我修养">
<meta property="og:description" content="Pandas is a software library written for the Python programming language for data manipulation and analysis. In particular, it offers data structures and operations for manipulating numerical tables a">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/08/09/2sYXwjC1ZRBKmpl.jpg">
<meta property="article:published_time" content="2020-08-18T14:49:17.000Z">
<meta property="article:modified_time" content="2020-12-25T18:32:50.187Z">
<meta property="article:author" content="阿平">
<meta property="article:tag" content="Data">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/08/09/2sYXwjC1ZRBKmpl.jpg"><link rel="shortcut icon" href="/images/panda.png"><link rel="canonical" href="https://www.facequant.com/2020/08/18/Introduction-to-Pandas/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="_MQwHkUtYfuk8J0qAPSV-zpAugCAnNbea8RvdD-C5DA"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-153134572-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-153134572-1');
</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-12-26 02:32:50'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/images/human.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">27</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div id="body-wrap"><header class="no-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">阿平的自我修养</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Introduction to Pandas</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-08-18T14:49:17.000Z" title="发表于 2020-08-18 22:49:17">2020-08-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-12-25T18:32:50.187Z" title="更新于 2020-12-26 02:32:50">2020-12-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Tools/">Tools</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">17.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>83分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><article class="post-content" id="article-container"><p>Pandas is a software library written for the Python programming language for data manipulation and analysis. In particular, it offers data structures and operations for manipulating numerical tables and time series.</p>
<h2 id="Topic-1-Data-Structure"><a href="#Topic-1-Data-Structure" class="headerlink" title="Topic 1 Data Structure"></a>Topic 1 Data Structure</h2><h3 id="1-1-Overview"><a href="#1-1-Overview" class="headerlink" title="1.1 Overview"></a>1.1 Overview</h3><p>Pandas包含以下三个<strong>数据结构</strong>: </p>
<ul>
<li>系列(<code>Series</code>)</li>
<li>数据帧(<code>DataFrame</code>)</li>
<li>面板(<code>Panel</code>)</li>
</ul>
<p>这些数据结构构建在<strong>Numpy</strong>数组之上，这意味着它们处理速度很快.</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">数据结构</th>
<th style="text-align:center">维数</th>
<th style="text-align:center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Series</td>
<td style="text-align:center">1</td>
<td style="text-align:center">一维数组, 大小<code>不</code>可变，由<strong>同种数据类型</strong>元素组成.</td>
</tr>
<tr>
<td style="text-align:center">DataFrame</td>
<td style="text-align:center">2</td>
<td style="text-align:center">二维数组, 大小<code>可变</code>的表格结构, 它含有一组有序的列, 每列可以是不同的数据类型（整型、字符串、 布尔值等）</td>
</tr>
<tr>
<td style="text-align:center">Panel</td>
<td style="text-align:center">3</td>
<td style="text-align:center">大小<code>可变</code>的三维数组</td>
</tr>
</tbody>
</table>
</div>
<p>可以简单理解为, 高维数据结构是低维数据结构的容器. 例如，<code>DataFrame</code>是<code>Series</code>的容器, <code>Panel</code>是<code>DataFrame</code>的容器.</p>
<h3 id="1-2-Series"><a href="#1-2-Series" class="headerlink" title="1.2 Series"></a>1.2 Series</h3><p>Series是由<strong>相同数据类型</strong>组成的一维数组. 有三个关键点:</p>
<ul>
<li>同种类型数据构成 (同 numpy 的 ndarray)</li>
<li>大小<code>不</code>可变</li>
<li>数据可变</li>
</ul>
<h3 id="1-3-DataFrame"><a href="#1-3-DataFrame" class="headerlink" title="1.3 DataFrame"></a>1.3 DataFrame</h3><p>数据帧 (<strong>DataFrame</strong>) 是大小可变的数据结构, 每列可以是不同的数据类型 (整型、字符串、布尔值等). 有三个关键点:</p>
<ul>
<li>可以由不同的数据类型构成</li>
<li>大小可变</li>
<li>数据可变</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">姓名</th>
<th style="text-align:center">年龄</th>
<th style="text-align:center">性别</th>
<th style="text-align:center">等级</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Maxsu</td>
<td style="text-align:center">25</td>
<td style="text-align:center">男</td>
<td style="text-align:center">4.45</td>
</tr>
<tr>
<td style="text-align:center">Katie</td>
<td style="text-align:center">34</td>
<td style="text-align:center">女</td>
<td style="text-align:center">2.78</td>
</tr>
<tr>
<td style="text-align:center">Vina</td>
<td style="text-align:center">46</td>
<td style="text-align:center">女</td>
<td style="text-align:center">3.9</td>
</tr>
<tr>
<td style="text-align:center">Lia</td>
<td style="text-align:center">女</td>
<td style="text-align:center">女</td>
<td style="text-align:center">4.6</td>
</tr>
</tbody>
</table>
</div>
<p>上表表示某销售团队的绩效评级数据, 数据以行和列表示, 每列表示一个属性, 每行代表一个人. DataFrame 四列的数据类型分别为: 字符串, 整数, 字符串, 浮点型.</p>
<h3 id="1-4-Panel"><a href="#1-4-Panel" class="headerlink" title="1.4 Panel"></a>1.4 Panel</h3><p>面板(<strong>Panel</strong>)可以由不同的数据类型构成的三维数据结构, <code>Panel</code>是<code>DataFrame</code>的容器.</p>
<h2 id="Topic-2-Series"><a href="#Topic-2-Series" class="headerlink" title="Topic 2 Series"></a>Topic 2 Series</h2><p>序列 (<strong>Series</strong>) 是 pandas 中的一维数据结构，类似于 python 中的 list 和 <a target="_blank" rel="noopener" href="https://facequant.com/2020/08/18/Introduction-to-Numpy/">Numpy</a> 中的 <code>ndarray</code> 对象,在 <code>Series</code> 中包含的数据类型可以是整数，浮点数，字符串，python对象等.</p>
<h3 id="2-1-Series-Creation"><a href="#2-1-Series-Creation" class="headerlink" title="2.1 Series Creation"></a>2.1 Series Creation</h3><p>Series 的构造函数如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pandas.Series(data, index, dtype, copy)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># data: 支持多种数据类型，如：ndarray, list ...</span></span><br><span class="line"><span class="comment"># index: 索引值必须是唯一的(set), 与data的长度相同, 默认为np.arange(n)</span></span><br><span class="line"><span class="comment"># dtype: 数据类型, 同 numpy 中介绍的数据类型</span></span><br><span class="line"><span class="comment"># copy: 是否复制数据, 默认为 False</span></span><br></pre></td></tr></table></figure>
<p><strong>[例 2.1] 创建一个空的 Series</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series()</span><br><span class="line">print(<span class="string">&#x27;空 Series:\n&#x27;</span>,s)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">空 Series:</span><br><span class="line"> Series([], dtype: float64)</span><br></pre></td></tr></table></figure>
<p><strong>[例 2.2] 从 ndarray 创建一个 Series</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">a = np.array([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">s = pd.Series(a)</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0    a</span><br><span class="line">1    b</span><br><span class="line">2    c</span><br><span class="line">3    d</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<p><strong>注:</strong></p>
<p>我们其实可以根据实际情况传入索引, 也就是左边那一列</p>
<p><strong>[例 2.3]</strong> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">a = np.array([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">s = pd.Series(a,index=[<span class="number">100</span>,<span class="number">101</span>,<span class="number">102</span>,<span class="number">103</span>])</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">100    a</span><br><span class="line">101    b</span><br><span class="line">102    c</span><br><span class="line">103    d</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<p><strong>[例 2.4] 从字典创建一个 Series</strong></p>
<p><code>key</code> 是 <code>index</code>, <code>value</code> 是 <code>Series</code> 的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">a = &#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;b&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;c&#x27;</span>:<span class="number">3</span>&#125;</span><br><span class="line">s = pd.Series(a)</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a    1</span><br><span class="line">b    2</span><br><span class="line">c    3</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p><strong>注:</strong></p>
<p>我们也可以传入索引</p>
<p><strong>[例 2.5]</strong></p>
<p>索引顺序保持不变, 缺少的元素使用NaN(不是数字)填充.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">a = &#123;<span class="string">&#x27;a&#x27;</span>:<span class="number">1</span>,<span class="string">&#x27;b&#x27;</span>:<span class="number">2</span>,<span class="string">&#x27;c&#x27;</span>:<span class="number">3</span>&#125;</span><br><span class="line">s = pd.Series(a,index=[<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;a&#x27;</span>])</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">b    2.0</span><br><span class="line">c    3.0</span><br><span class="line">d    NaN</span><br><span class="line">e    NaN</span><br><span class="line">a    1.0</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p><strong>[例 2.6] 从标量创建一个 Series</strong></p>
<p>如果数据是标量类型, 则<strong>必须提供索引</strong>. 重复该值以匹配索引的长度.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series(<span class="number">5</span>, index=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0    5</span><br><span class="line">1    5</span><br><span class="line">2    5</span><br><span class="line">3    5</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="2-2-Reading-Series"><a href="#2-2-Reading-Series" class="headerlink" title="2.2 Reading Series"></a>2.2 Reading Series</h3><p>Series 中的数据可以使用类似于访问 <code>ndarray</code> 中的数据来访问.</p>
<p><strong>[例 2.7] 检索第一个元素</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;获取第一个元素:\n&#x27;</span>,s[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">获取第一个元素:</span><br><span class="line"> 1</span><br></pre></td></tr></table></figure>
<p><strong>[例 2.8] 获取前三个元素</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;获取前三个元素:&#x27;</span>)</span><br><span class="line">print(s[:<span class="number">3</span>])</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">获取前三个元素:</span><br><span class="line">a    1</span><br><span class="line">b    2</span><br><span class="line">c    3</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p>我们也能通过 <code>Series</code> 的 <code>index</code> 来访问其数据.</p>
<p><strong>[例 2.9] 使用 index 访问单个数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;访问索引为 d 的元素:\n&#x27;</span>,s[<span class="string">&#x27;d&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">访问索引为 d 的元素:</span><br><span class="line"> 4</span><br></pre></td></tr></table></figure>
<p><strong>[例 2.10] 使用索引访问多个元素</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;使用索引访问多个元素:&#x27;</span>)</span><br><span class="line">print(s[[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>]])</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">使用索引访问多个元素:</span><br><span class="line">a    1</span><br><span class="line">c    3</span><br><span class="line">d    4</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="2-3-Properties-of-Series"><a href="#2-3-Properties-of-Series" class="headerlink" title="2.3 Properties of Series"></a>2.3 Properties of Series</h3><div class="table-container">
<table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>axes</code></td>
<td>返回 Series 的索引列表</td>
</tr>
<tr>
<td><code>dtype</code></td>
<td>返回 Series 的数据类型</td>
</tr>
<tr>
<td><code>empty</code></td>
<td>判断 Series 是否为空, 若为空, 返回 True</td>
</tr>
<tr>
<td><code>ndim</code></td>
<td>返回基础数据的维数</td>
</tr>
<tr>
<td><code>size</code></td>
<td>返回基础数据中的元素个数</td>
</tr>
<tr>
<td><code>values</code></td>
<td>将 Series 作为 <code>ndarray</code> 返回</td>
</tr>
<tr>
<td><code>head()</code></td>
<td>返回前 n 个元素</td>
</tr>
<tr>
<td><code>tail()</code></td>
<td>返回最后 n 个元素</td>
</tr>
</tbody>
</table>
</div>
<h4 id="2-3-1-Series-axes"><a href="#2-3-1-Series-axes" class="headerlink" title="2.3.1 Series.axes"></a>2.3.1 Series.axes</h4><p><strong>[例 2.11] 返回 Series 的索引列表</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">s = pd.Series(np.random.randn(<span class="number">4</span>))</span><br><span class="line">print(<span class="string">&#x27;数据的索引是:\n&#x27;</span>,s.axes)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">数据的索引是:</span><br><span class="line"> [RangeIndex(start&#x3D;0, stop&#x3D;4, step&#x3D;1)]</span><br></pre></td></tr></table></figure>
<h4 id="2-3-2-Series-empty"><a href="#2-3-2-Series-empty" class="headerlink" title="2.3.2 Series.empty"></a>2.3.2 Series.empty</h4><p><strong>[例 2.12] 查看 Series 是否为空</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">s = pd.Series(np.random.randn(<span class="number">4</span>))</span><br><span class="line">print(<span class="string">&#x27;数据为空?\n&#x27;</span>,s.empty)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">数据为空?</span><br><span class="line"> False</span><br></pre></td></tr></table></figure>
<h4 id="2-3-3-Series-ndim"><a href="#2-3-3-Series-ndim" class="headerlink" title="2.3.3 Series.ndim"></a>2.3.3 Series.ndim</h4><p><strong>[例 2.13] 返回数据的维数</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">s = pd.Series(np.random.randn(<span class="number">4</span>))</span><br><span class="line">print(<span class="string">&#x27;数据的维数:\n&#x27;</span>,s.ndim)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">数据的维数:</span><br><span class="line"> 1</span><br></pre></td></tr></table></figure>
<h4 id="2-3-4-Series-size"><a href="#2-3-4-Series-size" class="headerlink" title="2.3.4 Series.size"></a>2.3.4 Series.size</h4><p><strong>[例 2.14] 查看 Series 中的元素个数</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">s = pd.Series(np.random.randn(<span class="number">4</span>))</span><br><span class="line">print(<span class="string">&#x27;Series 包含的元素个数:\n&#x27;</span>,s.size)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Series 包含的元素个数:</span><br><span class="line"> 4</span><br></pre></td></tr></table></figure>
<h4 id="2-3-5-Series-values"><a href="#2-3-5-Series-values" class="headerlink" title="2.3.5 Series.values"></a>2.3.5 Series.values</h4><p><strong>[例 2.15] 将 Series 作为 ndarray 返回</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">s = pd.Series(np.random.randn(<span class="number">4</span>))</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:\n&#x27;</span>,s)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;将数据转换成 ndarray.&#x27;</span>)</span><br><span class="line">a = s.values</span><br><span class="line">print(<span class="string">&#x27;数据类型是:\n&#x27;</span>,<span class="built_in">type</span>(a))</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line"> 0    0.139829</span><br><span class="line">1   -0.858539</span><br><span class="line">2   -0.060587</span><br><span class="line">3    0.087893</span><br><span class="line">dtype: float64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">将数据转换成 ndarray.</span><br><span class="line">数据类型是:</span><br><span class="line"> &lt;class &#39;numpy.ndarray&#39;&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Topic-3-DataFrame"><a href="#Topic-3-DataFrame" class="headerlink" title="Topic 3 DataFrame"></a>Topic 3 DataFrame</h2><p><code>DataFrame</code> 是二维数据结构, 它包含一组有序的列, 每列可以是不同的数据类型, <code>DataFrame</code>既有行索引, 也有列索引, 它可以看作是<code>Series</code>组成的字典, 不过这些<code>Series</code>共用一个索引. 其包含以下几个功能特点:</p>
<ul>
<li>不同的列可以是不同的数据类型</li>
<li>大小可变</li>
<li>包含行索引和列索引</li>
<li>可以对行和列执行算术运算</li>
</ul>
<h3 id="3-1-DataFrame-Creation"><a href="#3-1-DataFrame-Creation" class="headerlink" title="3.1 DataFrame Creation"></a>3.1 DataFrame Creation</h3><p>DataFrame 的构造函数如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pandas.DataFrame(data, index, columns, dtype, copy)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># data: 支持多种数据类型，如:ndarray，series, lists, dict, constant 或另外一个 DataFrame</span></span><br><span class="line"><span class="comment"># index: 行标签, 如果没有传递索引值, 默认值为np.arange(n)</span></span><br><span class="line"><span class="comment"># columns: 列标签, 如果没有传递索引值, 默认值为np.arange(n)</span></span><br><span class="line"><span class="comment"># dtype: 每列的数据类型</span></span><br><span class="line"><span class="comment"># copy: 是否复制数据, 默认为 False</span></span><br></pre></td></tr></table></figure>
<p><strong>[例 3.1] 创建一个空的 DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame()</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Empty DataFrame</span><br><span class="line">Columns: []</span><br><span class="line">Index: []</span><br></pre></td></tr></table></figure>
<p><strong>[例 3.2] 从一个二维列表创建 DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">l = [[<span class="string">&#x27;Alex&#x27;</span>,<span class="number">10</span>],[<span class="string">&#x27;Bob&#x27;</span>,<span class="number">12</span>],[<span class="string">&#x27;Clarke&#x27;</span>,<span class="number">13</span>]]</span><br><span class="line">df = pd.DataFrame(l, columns=[<span class="string">&#x27;Name&#x27;</span>,<span class="string">&#x27;Age&#x27;</span>])</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">     Name  Age</span><br><span class="line">0    Alex   10</span><br><span class="line">1     Bob   12</span><br><span class="line">2  Clarke   13</span><br></pre></td></tr></table></figure>
<p><strong>[例 3.3] 从一个 dict 创建 DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&#x27;Name&#x27;</span>:[<span class="string">&#x27;Tom&#x27;</span>,<span class="string">&#x27;Jack&#x27;</span>,<span class="string">&#x27;Steve&#x27;</span>,<span class="string">&#x27;Ricky&#x27;</span>],<span class="string">&#x27;Age&#x27;</span>:[<span class="number">28</span>,<span class="number">34</span>,<span class="number">29</span>,<span class="number">42</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data, index=[<span class="string">&#x27;1st&#x27;</span>,<span class="string">&#x27;2nd&#x27;</span>,<span class="string">&#x27;3rd&#x27;</span>,<span class="string">&#x27;4th&#x27;</span>])</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">      Name  Age</span><br><span class="line">1st    Tom   28</span><br><span class="line">2nd   Jack   34</span><br><span class="line">3rd  Steve   29</span><br><span class="line">4th  Ricky   42</span><br></pre></td></tr></table></figure>
<p><strong>[例 3.4] 从 ndarray 创建 DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">a = np.array([[<span class="string">&#x27;Tom&#x27;</span>,<span class="number">28</span>],[<span class="string">&#x27;Jack&#x27;</span>,<span class="number">34</span>],[<span class="string">&#x27;Steve&#x27;</span>,<span class="number">29</span>],[<span class="string">&#x27;Ricky&#x27;</span>,<span class="number">42</span>]])</span><br><span class="line">df = pd.DataFrame(a, index=[<span class="string">&#x27;1st&#x27;</span>,<span class="string">&#x27;2nd&#x27;</span>,<span class="string">&#x27;3rd&#x27;</span>,<span class="string">&#x27;4th&#x27;</span>],columns=[<span class="string">&#x27;Name&#x27;</span>,<span class="string">&#x27;Age&#x27;</span>])</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">      Name Age</span><br><span class="line">1st    Tom  28</span><br><span class="line">2nd   Jack  34</span><br><span class="line">3rd  Steve  29</span><br><span class="line">4th  Ricky  42</span><br></pre></td></tr></table></figure>
<p><strong>[例 3.5] 从 Series 字典来创建 DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">d = &#123;<span class="string">&#x27;one&#x27;</span> : pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]),</span><br><span class="line">      <span class="string">&#x27;two&#x27;</span> : pd.Series([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], index=[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   one  two</span><br><span class="line">a  1.0    1</span><br><span class="line">b  2.0    2</span><br><span class="line">c  3.0    3</span><br><span class="line">d  NaN    4</span><br></pre></td></tr></table></figure>
<h3 id="3-2-DataFrame-Operations"><a href="#3-2-DataFrame-Operations" class="headerlink" title="3.2 DataFrame Operations"></a>3.2 DataFrame Operations</h3><h4 id="3-2-1-Reading-Data-from-Columns"><a href="#3-2-1-Reading-Data-from-Columns" class="headerlink" title="3.2.1 Reading Data from Columns"></a>3.2.1 Reading Data from Columns</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">a = np.array([[<span class="string">&#x27;Tom&#x27;</span>,<span class="number">28</span>],[<span class="string">&#x27;Jack&#x27;</span>,<span class="number">34</span>],[<span class="string">&#x27;Steve&#x27;</span>,<span class="number">29</span>],[<span class="string">&#x27;Ricky&#x27;</span>,<span class="number">42</span>]])</span><br><span class="line">df = pd.DataFrame(a, index=[<span class="string">&#x27;1st&#x27;</span>,<span class="string">&#x27;2nd&#x27;</span>,<span class="string">&#x27;3rd&#x27;</span>,<span class="string">&#x27;4th&#x27;</span>],columns=[<span class="string">&#x27;Name&#x27;</span>,<span class="string">&#x27;Age&#x27;</span>])</span><br><span class="line">print(df[<span class="string">&#x27;Name&#x27;</span>])  <span class="comment"># 也可以是 print(df.Name)</span></span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1st      Tom</span><br><span class="line">2nd     Jack</span><br><span class="line">3rd    Steve</span><br><span class="line">4th    Ricky</span><br><span class="line">Name: Name, dtype: object</span><br></pre></td></tr></table></figure>
<h4 id="3-2-2-Reading-Data-from-Rows"><a href="#3-2-2-Reading-Data-from-Rows" class="headerlink" title="3.2.2 Reading Data from Rows"></a>3.2.2 Reading Data from Rows</h4><p>有两种方式读取行数据:</p>
<ul>
<li><p>使用 <code>DataFrame.loc[]</code> 依据行索引进行读取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">a = np.array([[<span class="string">&#x27;Tom&#x27;</span>,<span class="number">28</span>],[<span class="string">&#x27;Jack&#x27;</span>,<span class="number">34</span>],[<span class="string">&#x27;Steve&#x27;</span>,<span class="number">29</span>],[<span class="string">&#x27;Ricky&#x27;</span>,<span class="number">42</span>]])</span><br><span class="line">df = pd.DataFrame(a, index=[<span class="string">&#x27;1st&#x27;</span>,<span class="string">&#x27;2nd&#x27;</span>,<span class="string">&#x27;3rd&#x27;</span>,<span class="string">&#x27;4th&#x27;</span>],columns=[<span class="string">&#x27;Name&#x27;</span>,<span class="string">&#x27;Age&#x27;</span>])</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;第三行的数据是:&#x27;</span>)</span><br><span class="line">print(df.loc[<span class="string">&#x27;3rd&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">第三行的数据是:</span><br><span class="line">Name    Steve</span><br><span class="line">Age        29</span><br><span class="line">Name: 3rd, dtype: object</span><br></pre></td></tr></table></figure></li>
<li><p>使用 <code>DataFrame.iloc[]</code> 依据 row number 进行读取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">a = np.array([[<span class="string">&#x27;Tom&#x27;</span>,<span class="number">28</span>],[<span class="string">&#x27;Jack&#x27;</span>,<span class="number">34</span>],[<span class="string">&#x27;Steve&#x27;</span>,<span class="number">29</span>],[<span class="string">&#x27;Ricky&#x27;</span>,<span class="number">42</span>]])</span><br><span class="line">df = pd.DataFrame(a, index=[<span class="string">&#x27;1st&#x27;</span>,<span class="string">&#x27;2nd&#x27;</span>,<span class="string">&#x27;3rd&#x27;</span>,<span class="string">&#x27;4th&#x27;</span>],columns=[<span class="string">&#x27;Name&#x27;</span>,<span class="string">&#x27;Age&#x27;</span>])</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;倒数两行的数据是:&#x27;</span>)</span><br><span class="line">print(df.iloc[-<span class="number">2</span>:])</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">倒数两行的数据是:</span><br><span class="line">      Name Age</span><br><span class="line">3rd  Steve  29</span><br><span class="line">4th  Ricky  42</span><br></pre></td></tr></table></figure>
<h4 id="3-2-3-Adding-and-Deleting-Columns"><a href="#3-2-3-Adding-and-Deleting-Columns" class="headerlink" title="3.2.3 Adding and Deleting Columns"></a>3.2.3 Adding and Deleting Columns</h4></li>
</ul>
<p><strong>添加列有两种方式:</strong></p>
<ul>
<li>传入新的 Series</li>
<li>利用现有列</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">a = np.array([[<span class="string">&#x27;Tom&#x27;</span>,<span class="number">28</span>],[<span class="string">&#x27;Jack&#x27;</span>,<span class="number">34</span>],[<span class="string">&#x27;Steve&#x27;</span>,<span class="number">29</span>],[<span class="string">&#x27;Ricky&#x27;</span>,<span class="number">42</span>]])</span><br><span class="line">df = pd.DataFrame(a, index=[<span class="string">&#x27;1st&#x27;</span>,<span class="string">&#x27;2nd&#x27;</span>,<span class="string">&#x27;3rd&#x27;</span>,<span class="string">&#x27;4th&#x27;</span>],columns=[<span class="string">&#x27;Name&#x27;</span>,<span class="string">&#x27;Age&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;原 DataFrame:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;通过传入一个新的 Series 来增加新列:&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;Sex&#x27;</span>] = pd.Series([<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Female&#x27;</span>],index=[<span class="string">&#x27;1st&#x27;</span>,<span class="string">&#x27;2nd&#x27;</span>,<span class="string">&#x27;3rd&#x27;</span>,<span class="string">&#x27;4th&#x27;</span>])</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;通过操作已有列来增加新列:&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;Name and Sex&#x27;</span>] = df[<span class="string">&#x27;Name&#x27;</span>] + df[<span class="string">&#x27;Sex&#x27;</span>]</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">原 DataFrame:</span><br><span class="line">      Name Age</span><br><span class="line">1st    Tom  28</span><br><span class="line">2nd   Jack  34</span><br><span class="line">3rd  Steve  29</span><br><span class="line">4th  Ricky  42</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">通过传入一个新的 Series 来增加新列:</span><br><span class="line">      Name Age     Sex</span><br><span class="line">1st    Tom  28    Male</span><br><span class="line">2nd   Jack  34    Male</span><br><span class="line">3rd  Steve  29    Male</span><br><span class="line">4th  Ricky  42  Female</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">通过操作已有列来增加新列:</span><br><span class="line">      Name Age     Sex Name and Sex</span><br><span class="line">1st    Tom  28    Male      TomMale</span><br><span class="line">2nd   Jack  34    Male     JackMale</span><br><span class="line">3rd  Steve  29    Male    SteveMale</span><br><span class="line">4th  Ricky  42  Female  RickyFemale</span><br></pre></td></tr></table></figure>
<p><strong>删除列有两种方式:</strong></p>
<ul>
<li>使用 <code>del</code> 关键字</li>
<li>使用 <code>DataFrame.pop()</code> 函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">a = np.array([[<span class="string">&#x27;Tom&#x27;</span>,<span class="number">28</span>],[<span class="string">&#x27;Jack&#x27;</span>,<span class="number">34</span>],[<span class="string">&#x27;Steve&#x27;</span>,<span class="number">29</span>],[<span class="string">&#x27;Ricky&#x27;</span>,<span class="number">42</span>]])</span><br><span class="line">df = pd.DataFrame(a, index=[<span class="string">&#x27;1st&#x27;</span>,<span class="string">&#x27;2nd&#x27;</span>,<span class="string">&#x27;3rd&#x27;</span>,<span class="string">&#x27;4th&#x27;</span>],columns=[<span class="string">&#x27;Name&#x27;</span>,<span class="string">&#x27;Age&#x27;</span>])</span><br><span class="line">df[<span class="string">&#x27;Sex&#x27;</span>] = pd.Series([<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Female&#x27;</span>],index=[<span class="string">&#x27;1st&#x27;</span>,<span class="string">&#x27;2nd&#x27;</span>,<span class="string">&#x27;3rd&#x27;</span>,<span class="string">&#x27;4th&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;原 DataFrame:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;使用 del 关键字:&#x27;</span>)</span><br><span class="line"><span class="keyword">del</span> df[<span class="string">&#x27;Sex&#x27;</span>]</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;使用 DataFrame.pop() 函数&#x27;</span>) <span class="comment"># 如你在 python 中学的 pop 函数一样, 这个函数会返回该列</span></span><br><span class="line">print(<span class="string">&#x27;返回列:&#x27;</span>)</span><br><span class="line">df.pop(<span class="string">&#x27;Age&#x27;</span>)</span><br><span class="line">print()</span><br><span class="line">print(<span class="string">&#x27;修改之后的 DataFrame:&#x27;</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">原 DataFrame:</span><br><span class="line">      Name Age     Sex</span><br><span class="line">1st    Tom  28    Male</span><br><span class="line">2nd   Jack  34    Male</span><br><span class="line">3rd  Steve  29    Male</span><br><span class="line">4th  Ricky  42  Female</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用 del 关键字:</span><br><span class="line">      Name Age</span><br><span class="line">1st    Tom  28</span><br><span class="line">2nd   Jack  34</span><br><span class="line">3rd  Steve  29</span><br><span class="line">4th  Ricky  42</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用 DataFrame.pop() 函数</span><br><span class="line">返回列:</span><br><span class="line">1st    28</span><br><span class="line">2nd    34</span><br><span class="line">3rd    29</span><br><span class="line">4th    42</span><br><span class="line">Name: Age, dtype: object</span><br><span class="line"></span><br><span class="line">修改之后的 DataFrame:</span><br><span class="line">      Name</span><br><span class="line">1st    Tom</span><br><span class="line">2nd   Jack</span><br><span class="line">3rd  Steve</span><br><span class="line">4th  Ricky</span><br></pre></td></tr></table></figure>
<h4 id="3-2-4-Adding-and-Deleting-Rows"><a href="#3-2-4-Adding-and-Deleting-Rows" class="headerlink" title="3.2.4 Adding and Deleting Rows"></a>3.2.4 Adding and Deleting Rows</h4><p><strong>添加行只有一种方式:</strong> <code>DataFrame.append(pandas.DataFrame)</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]],columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line">df2 = pd.DataFrame([[<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>]],columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;df1:&#x27;</span>)</span><br><span class="line">print(df1)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;df2:&#x27;</span>)</span><br><span class="line">print(df2)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;将 df2 添加到 df1 之后:&#x27;</span>)</span><br><span class="line">print(df1.append(df2))</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">df1:</span><br><span class="line">   a  b</span><br><span class="line">0  1  2</span><br><span class="line">1  3  4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df2:</span><br><span class="line">   a  b</span><br><span class="line">0  5  6</span><br><span class="line">1  7  8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">将 df2 添加到 df1 之后:</span><br><span class="line">   a  b</span><br><span class="line">0  1  2</span><br><span class="line">1  3  4</span><br><span class="line">0  5  6</span><br><span class="line">1  7  8</span><br></pre></td></tr></table></figure>
<p><strong>使用索引标签从 DataFrame 中删除行. 如果标签重复, 则会删除多行.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]],columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line">df2 = pd.DataFrame([[<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>]],columns=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"></span><br><span class="line">df1 = df1.append(df2)</span><br><span class="line">print(<span class="string">&#x27;删除行标为 0 的行:&#x27;</span>)</span><br><span class="line">df1 = df1.drop(<span class="number">0</span>)</span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">删除行标为 0 的行:</span><br><span class="line">   a  b</span><br><span class="line">1  3  4</span><br><span class="line">1  7  8</span><br></pre></td></tr></table></figure>
<h4 id="3-2-5-Reindexing-and-Renaming"><a href="#3-2-5-Reindexing-and-Renaming" class="headerlink" title="3.2.5 Reindexing and Renaming"></a>3.2.5 Reindexing and Renaming</h4><ol>
<li><p>DataFrame.reindex()</p>
<p><strong>我们首先看对 Series 重新索引</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"></span><br><span class="line">s = pd.Series([<span class="number">1</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">9</span>],index=[<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;f&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(s)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;reindex 函数会对数据重新排序, 缺失值会有 NaN 填补:&#x27;</span>)</span><br><span class="line">s = s.reindex(index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>])</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">d    1</span><br><span class="line">c    7</span><br><span class="line">a    3</span><br><span class="line">f    9</span><br><span class="line">dtype: int64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">reindex 函数会对数据重新排序, 缺失值会有 NaN 填补:</span><br><span class="line">a    3.0</span><br><span class="line">b    NaN</span><br><span class="line">c    7.0</span><br><span class="line">d    1.0</span><br><span class="line">e    NaN</span><br><span class="line">f    9.0</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<p><strong>和 <code>fillna()</code> 函数一样, reindex 可以选择重新索引时的数据插入方式来填补缺失值</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series([<span class="string">&#x27;blue&#x27;</span>,<span class="string">&#x27;red&#x27;</span>,<span class="string">&#x27;black&#x27;</span>],index=[<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>])</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(s)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;reindex 之后数据是:&#x27;</span>)</span><br><span class="line">s = s.reindex(index=<span class="built_in">range</span>(<span class="number">6</span>),method=<span class="string">&#x27;ffill&#x27;</span>) <span class="comment"># 前向填充</span></span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">0     blue</span><br><span class="line">2      red</span><br><span class="line">4    black</span><br><span class="line">dtype: object</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">reindex 之后数据是:</span><br><span class="line">0     blue</span><br><span class="line">1     blue</span><br><span class="line">2      red</span><br><span class="line">3      red</span><br><span class="line">4    black</span><br><span class="line">5    black</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<p><strong>我们再来看一下对 DataFrame 的索引</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">s = pd.DataFrame(np.arange(<span class="number">9</span>).reshape(<span class="number">3</span>,<span class="number">3</span>), index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>], columns=[<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;four&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>) </span><br><span class="line">print(s)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;使用 reindex 填充数据, 传入参数 fill_value 可以填充缺失值:&#x27;</span>)</span><br><span class="line">s = s.reindex(index=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>],columns=[<span class="string">&#x27;one&#x27;</span>,<span class="string">&#x27;two&#x27;</span>,<span class="string">&#x27;three&#x27;</span>,<span class="string">&#x27;four&#x27;</span>],fill_value=<span class="number">100</span>)</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">   one  two  four</span><br><span class="line">a    0    1     2</span><br><span class="line">c    3    4     5</span><br><span class="line">d    6    7     8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用 reindex 填充数据, 传入参数 fill_value 可以填充缺失值:</span><br><span class="line">   one  two  three  four</span><br><span class="line">a    0    1    100     2</span><br><span class="line">b  100  100    100   100</span><br><span class="line">c    3    4    100     5</span><br><span class="line">d    6    7    100     8</span><br></pre></td></tr></table></figure></li>
<li><p>DataFrame.rename()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&quot;A&quot;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">&quot;B&quot;</span>: [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]&#125;)</span><br><span class="line">df.rename(columns=&#123;<span class="string">&quot;A&quot;</span>: <span class="string">&quot;a&quot;</span>, <span class="string">&quot;B&quot;</span>: <span class="string">&quot;c&quot;</span>&#125;)</span><br><span class="line">   a  c</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span>  <span class="number">4</span></span><br><span class="line"><span class="number">1</span>  <span class="number">2</span>  <span class="number">5</span></span><br><span class="line"><span class="number">2</span>  <span class="number">3</span>  <span class="number">6</span></span><br><span class="line"></span><br><span class="line">df.rename(index=&#123;<span class="number">0</span>: <span class="string">&quot;x&quot;</span>, <span class="number">1</span>: <span class="string">&quot;y&quot;</span>, <span class="number">2</span>: <span class="string">&quot;z&quot;</span>&#125;)</span><br><span class="line">   A  B</span><br><span class="line">x  <span class="number">1</span>  <span class="number">4</span></span><br><span class="line">y  <span class="number">2</span>  <span class="number">5</span></span><br><span class="line">z  <span class="number">3</span>  <span class="number">6</span></span><br><span class="line"></span><br><span class="line">df.rename(<span class="built_in">str</span>.lower, axis=<span class="string">&#x27;columns&#x27;</span>)</span><br><span class="line">   a  b</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span>  <span class="number">4</span></span><br><span class="line"><span class="number">1</span>  <span class="number">2</span>  <span class="number">5</span></span><br><span class="line"><span class="number">2</span>  <span class="number">3</span>  <span class="number">6</span></span><br><span class="line"></span><br><span class="line">df.rename(&#123;<span class="number">1</span>: <span class="number">2</span>, <span class="number">2</span>: <span class="number">4</span>&#125;, axis=<span class="string">&#x27;index&#x27;</span>)</span><br><span class="line">   A  B</span><br><span class="line"><span class="number">0</span>  <span class="number">1</span>  <span class="number">4</span></span><br><span class="line"><span class="number">2</span>  <span class="number">2</span>  <span class="number">5</span></span><br><span class="line"><span class="number">4</span>  <span class="number">3</span>  <span class="number">6</span></span><br></pre></td></tr></table></figure>
<h3 id="3-3-Properties-of-DataFrame"><a href="#3-3-Properties-of-DataFrame" class="headerlink" title="3.3 Properties of DataFrame"></a>3.3 Properties of DataFrame</h3></li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>T</code></td>
<td>转置行和列</td>
</tr>
<tr>
<td><code>axes</code></td>
<td>返回 DataFrame 的行和列标签</td>
</tr>
<tr>
<td><code>dtype</code></td>
<td>返回 DataFrame 中每一列的数据类型</td>
</tr>
<tr>
<td><code>empty</code></td>
<td>若 DataFrame 为空, 则返回 <code>True</code></td>
</tr>
<tr>
<td><code>ndim</code></td>
<td>返回 DataFrame 维度的数量, 默认为 <code>2</code></td>
</tr>
<tr>
<td><code>shape</code></td>
<td>返回 DataFrame 的维度</td>
</tr>
<tr>
<td><code>size</code></td>
<td>返回 DataFrame 中元素的个数</td>
</tr>
<tr>
<td><code>values</code></td>
<td>将 DataFrame 中的数据以 <code>ndarray</code> 返回</td>
</tr>
<tr>
<td><code>head()</code></td>
<td>返回开头前 <code>n</code> 行</td>
</tr>
<tr>
<td><code>tail()</code></td>
<td>返回最后 <code>n</code> 行</td>
</tr>
</tbody>
</table>
</div>
<h4 id="3-3-1-DataFrame-T"><a href="#3-3-1-DataFrame-T" class="headerlink" title="3.3.1 DataFrame.T"></a>3.3.1 DataFrame.T</h4><p>返回<code>DataFrame</code>的转置, 行和列将交换:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">d = &#123;<span class="string">&#x27;Name&#x27;</span>:pd.Series([<span class="string">&#x27;Tom&#x27;</span>,<span class="string">&#x27;James&#x27;</span>,<span class="string">&#x27;Ricky&#x27;</span>,<span class="string">&#x27;Vin&#x27;</span>,<span class="string">&#x27;Steve&#x27;</span>,<span class="string">&#x27;Minsu&#x27;</span>,<span class="string">&#x27;Jack&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;Age&#x27;</span>:pd.Series([<span class="number">25</span>,<span class="number">26</span>,<span class="number">25</span>,<span class="number">23</span>,<span class="number">30</span>,<span class="number">29</span>,<span class="number">23</span>]),</span><br><span class="line">   <span class="string">&#x27;Rating&#x27;</span>:pd.Series([<span class="number">4.23</span>,<span class="number">3.24</span>,<span class="number">3.98</span>,<span class="number">2.56</span>,<span class="number">3.20</span>,<span class="number">4.6</span>,<span class="number">3.8</span>])&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line">print(<span class="string">&#x27;原数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;转置之后的数据是:&#x27;</span>)</span><br><span class="line">print(df.T)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">原数据是:</span><br><span class="line">    Name  Age  Rating</span><br><span class="line">0    Tom   25    4.23</span><br><span class="line">1  James   26    3.24</span><br><span class="line">2  Ricky   25    3.98</span><br><span class="line">3    Vin   23    2.56</span><br><span class="line">4  Steve   30    3.20</span><br><span class="line">5  Minsu   29    4.60</span><br><span class="line">6   Jack   23    3.80</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">转置之后的数据是:</span><br><span class="line">           0      1      2     3      4      5     6</span><br><span class="line">Name     Tom  James  Ricky   Vin  Steve  Minsu  Jack</span><br><span class="line">Age       25     26     25    23     30     29    23</span><br><span class="line">Rating  4.23   3.24   3.98  2.56    3.2    4.6   3.8</span><br></pre></td></tr></table></figure>
<h4 id="3-3-2-DataFrame-axes"><a href="#3-3-2-DataFrame-axes" class="headerlink" title="3.3.2 DataFrame.axes"></a>3.3.2 DataFrame.axes</h4><p>返回 <code>DataFrame</code> 的行轴标签和列轴标签列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">d = &#123;<span class="string">&#x27;Name&#x27;</span>:pd.Series([<span class="string">&#x27;Tom&#x27;</span>,<span class="string">&#x27;James&#x27;</span>,<span class="string">&#x27;Ricky&#x27;</span>,<span class="string">&#x27;Vin&#x27;</span>,<span class="string">&#x27;Steve&#x27;</span>,<span class="string">&#x27;Minsu&#x27;</span>,<span class="string">&#x27;Jack&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;Age&#x27;</span>:pd.Series([<span class="number">25</span>,<span class="number">26</span>,<span class="number">25</span>,<span class="number">23</span>,<span class="number">30</span>,<span class="number">29</span>,<span class="number">23</span>]),</span><br><span class="line">   <span class="string">&#x27;Rating&#x27;</span>:pd.Series([<span class="number">4.23</span>,<span class="number">3.24</span>,<span class="number">3.98</span>,<span class="number">2.56</span>,<span class="number">3.20</span>,<span class="number">4.6</span>,<span class="number">3.8</span>])&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line">print(<span class="string">&#x27;行标签和列标签是:&#x27;</span>)</span><br><span class="line">print(df.axes)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">行标签和列标签是:</span><br><span class="line">[RangeIndex(start&#x3D;0, stop&#x3D;7, step&#x3D;1), Index([&#39;Name&#39;, &#39;Age&#39;, &#39;Rating&#39;], dtype&#x3D;&#39;object&#39;)]</span><br></pre></td></tr></table></figure>
<h4 id="3-3-3-DataFrame-dtypes"><a href="#3-3-3-DataFrame-dtypes" class="headerlink" title="3.3.3 DataFrame.dtypes"></a>3.3.3 DataFrame.dtypes</h4><p>返回每列的数据类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">d = &#123;<span class="string">&#x27;Name&#x27;</span>:pd.Series([<span class="string">&#x27;Tom&#x27;</span>,<span class="string">&#x27;James&#x27;</span>,<span class="string">&#x27;Ricky&#x27;</span>,<span class="string">&#x27;Vin&#x27;</span>,<span class="string">&#x27;Steve&#x27;</span>,<span class="string">&#x27;Minsu&#x27;</span>,<span class="string">&#x27;Jack&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;Age&#x27;</span>:pd.Series([<span class="number">25</span>,<span class="number">26</span>,<span class="number">25</span>,<span class="number">23</span>,<span class="number">30</span>,<span class="number">29</span>,<span class="number">23</span>]),</span><br><span class="line">   <span class="string">&#x27;Rating&#x27;</span>:pd.Series([<span class="number">4.23</span>,<span class="number">3.24</span>,<span class="number">3.98</span>,<span class="number">2.56</span>,<span class="number">3.20</span>,<span class="number">4.6</span>,<span class="number">3.8</span>])&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line">print(<span class="string">&#x27;每列的数据类型:&#x27;</span>)</span><br><span class="line">print(df.dtypes)</span><br></pre></td></tr></table></figure>
<p>数据类型是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">每列的数据类型:</span><br><span class="line">Name       object</span><br><span class="line">Age         int64</span><br><span class="line">Rating    float64</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<h3 id="3-4-DataFrame-MultiIndex"><a href="#3-4-DataFrame-MultiIndex" class="headerlink" title="3.4 DataFrame MultiIndex"></a>3.4 DataFrame MultiIndex</h3><p><code>MultiIndex</code> 表示多级索引, 它是从Index继承过来的, 其中多级标签用<strong>元组对象</strong>来表示.</p>
<h4 id="3-4-1-MultiIndex-Creation"><a href="#3-4-1-MultiIndex-Creation" class="headerlink" title="3.4.1 MultiIndex Creation"></a>3.4.1 MultiIndex Creation</h4><p>我们主要使用 <code>pandas.MultiIndex.from_arrays()</code> 来创建多级索引.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">class1=[<span class="string">&quot;A&quot;</span>,<span class="string">&quot;A&quot;</span>,<span class="string">&quot;B&quot;</span>,<span class="string">&quot;B&quot;</span>,<span class="string">&#x27;B&#x27;</span>]</span><br><span class="line">class2=[<span class="string">&quot;x1&quot;</span>,<span class="string">&quot;x2&quot;</span>,<span class="string">&quot;y1&quot;</span>,<span class="string">&quot;y2&quot;</span>,<span class="string">&#x27;y3&#x27;</span>]</span><br><span class="line">multi_index=pd.MultiIndex.from_arrays([class1,class2],names=[<span class="string">&quot;class1&quot;</span>,<span class="string">&quot;class2&quot;</span>])</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randint(<span class="number">1</span>,<span class="number">10</span>,(<span class="number">5</span>,<span class="number">3</span>)),index=multi_index)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/21/7GHsnroSXdzyfvV.png" alt="image-20200821172656280" style="zoom:50%;" /></p>
<blockquote>
<p>  <strong>Series和DataFrame的列名称属性就是columns, 他也可以是一个 <code>MultiIndex</code> 对象:</strong></p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">arrays = [[<span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;baz&#x27;</span>, <span class="string">&#x27;baz&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;qux&#x27;</span>, <span class="string">&#x27;qux&#x27;</span>],</span><br><span class="line">            [<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>]]</span><br><span class="line"></span><br><span class="line">multi_index = pd.MultiIndex.from_arrays(arrays,names=[<span class="string">&#x27;FirstLevel&#x27;</span>,<span class="string">&#x27;SecondLevel&#x27;</span>])</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">3</span>, <span class="number">8</span>), index=[<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>], columns=multi_index)</span><br><span class="line">df</span><br></pre></td></tr></table></figure>
<p>  输出结果是:</p>
<p>  <img src="https://i.loli.net/2020/08/23/ACMJFl8EWd7fvhN.png" alt="image-20200821173753159"></p>
</blockquote>
<h4 id="3-4-2-Use-of-MultiIndex"><a href="#3-4-2-Use-of-MultiIndex" class="headerlink" title="3.4.2 Use of MultiIndex"></a>3.4.2 Use of MultiIndex</h4><p><strong>我们再来看一下如何使用 MultiIndex 选择数据</strong></p>
<p><strong>首先, 获取FirstLevel是bar的所有数据:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;bar&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/21/XHK2ysD9a8RFvM5.png" alt="image-20200821173853310" style="zoom:50%;" /></p>
<p><strong>获取FirstLevel是bar, SecondLevel是one的所有数据:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;bar&#x27;</span>,<span class="string">&#x27;one&#x27;</span>] <span class="comment"># 也可以是 df[&#x27;bar&#x27;][&#x27;one&#x27;]</span></span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/21/hWNnX8Lufr1G6Ji.png" alt="image-20200821173956442" style="zoom:50%;" /></p>
<p><strong>如果要选择第二层的列名为one的所有数据, 我们需要借助xs方法:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.xs(<span class="string">&#x27;one&#x27;</span>,level=<span class="number">1</span>,axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/21/uYSspi8VErZhPvF.png" alt="image-20200821174211172" style="zoom:50%;" /></p>
<p><strong>或者使用名称代替数字:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.xs(<span class="string">&#x27;one&#x27;</span>, level=<span class="string">&#x27;SecondLevel&#x27;</span>, axis=<span class="string">&#x27;columns&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/21/uYSspi8VErZhPvF.png" alt="image-20200821174211172" style="zoom:50%;" /></p>
<p><code>xs</code> 不仅可以用来选择列, 也可以用来选择行:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">class1=[<span class="string">&quot;A&quot;</span>,<span class="string">&quot;A&quot;</span>,<span class="string">&quot;B&quot;</span>,<span class="string">&quot;B&quot;</span>,<span class="string">&#x27;B&#x27;</span>]</span><br><span class="line">class2=[<span class="string">&quot;x1&quot;</span>,<span class="string">&quot;x2&quot;</span>,<span class="string">&quot;y1&quot;</span>,<span class="string">&quot;y2&quot;</span>,<span class="string">&#x27;y3&#x27;</span>]</span><br><span class="line">multi_index=pd.MultiIndex.from_arrays([class1,class2],names=[<span class="string">&quot;class1&quot;</span>,<span class="string">&quot;class2&quot;</span>])</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randint(<span class="number">1</span>,<span class="number">10</span>,(<span class="number">5</span>,<span class="number">3</span>)),index=multi_index)</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">print(<span class="string">&#x27;选取结果是:&#x27;</span>)</span><br><span class="line">df.xs(<span class="string">&#x27;x1&#x27;</span>,level=<span class="number">1</span>,axis=<span class="string">&#x27;index&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/21/jcughLPna6VAw5E.png" alt="image-20200821174735322" style="zoom:50%;" /></p>
<p><strong>注: 当然, 也可以使用我们学过的 <code>loc</code> 或者 <code>iloc</code> 函数.</strong></p>
<h3 id="3-5-DataFrame-Iteration"><a href="#3-5-DataFrame-Iteration" class="headerlink" title="3.5 DataFrame Iteration"></a>3.5 DataFrame Iteration</h3><p>我们可以直接迭代 <code>DataFrame</code> 和 <code>Series</code>:</p>
<ul>
<li><em>Series</em> - 值</li>
<li><em>DataFrame</em> - 列标签</li>
</ul>
<p>看个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">N=<span class="number">20</span></span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>: pd.date_range(start=<span class="string">&#x27;2016-01-01&#x27;</span>,periods=N,freq=<span class="string">&#x27;D&#x27;</span>),</span><br><span class="line">    <span class="string">&#x27;x&#x27;</span>: np.linspace(<span class="number">0</span>,stop=N-<span class="number">1</span>,num=N),</span><br><span class="line">    <span class="string">&#x27;y&#x27;</span>: np.random.rand(N),</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: np.random.choice([<span class="string">&#x27;Low&#x27;</span>,<span class="string">&#x27;Medium&#x27;</span>,<span class="string">&#x27;High&#x27;</span>],N).tolist(),</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>: np.random.normal(<span class="number">100</span>, <span class="number">10</span>, size=(N)).tolist()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> df:</span><br><span class="line">    print(col)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">A</span><br><span class="line">x</span><br><span class="line">y</span><br><span class="line">C</span><br><span class="line">D</span><br></pre></td></tr></table></figure>
<p>若我们要遍历 DataFrame 中的行, 我们使用以下函数:</p>
<ul>
<li><code>iteritems()</code> - 遍历每一列</li>
<li><code>iterrows()</code> - 遍历每一行</li>
<li><code>itertuples()</code></li>
</ul>
<h4 id="3-5-1-DataFrame-iteritems"><a href="#3-5-1-DataFrame-iteritems" class="headerlink" title="3.5.1 DataFrame.iteritems()"></a>3.5.1 DataFrame.iteritems()</h4><p><strong>列为 key, 列中的值为 value.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">4</span>,<span class="number">3</span>), columns=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>])</span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> df.iteritems():</span><br><span class="line">    print(<span class="string">&#x27;列名:&#x27;</span>,k)</span><br><span class="line">    print(v)</span><br><span class="line">    print(<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">列名: A</span><br><span class="line">0    0.296866</span><br><span class="line">1   -0.148633</span><br><span class="line">2    1.621515</span><br><span class="line">3   -0.660666</span><br><span class="line">Name: A, dtype: float64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">列名: B</span><br><span class="line">0   -0.253393</span><br><span class="line">1    0.574725</span><br><span class="line">2    0.503636</span><br><span class="line">3    0.204850</span><br><span class="line">Name: B, dtype: float64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">列名: C</span><br><span class="line">0    1.317005</span><br><span class="line">1    0.346061</span><br><span class="line">2    0.358695</span><br><span class="line">3    0.341376</span><br><span class="line">Name: C, dtype: float64</span><br></pre></td></tr></table></figure>
<h4 id="3-5-2-DataFrame-iterrows"><a href="#3-5-2-DataFrame-iterrows" class="headerlink" title="3.5.2 DataFrame.iterrows()"></a>3.5.2 DataFrame.iterrows()</h4><p><strong>返回迭代器,产生每个索引值以及包含每行数据的序列.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">4</span>,<span class="number">3</span>), columns=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>])</span><br><span class="line"><span class="keyword">for</span> row_index, row <span class="keyword">in</span> df.iterrows():</span><br><span class="line">    print(<span class="string">&#x27;行 index 是:&#x27;</span>, row_index)</span><br><span class="line">    print(row)</span><br><span class="line">    print(<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[102]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df &#x3D; pd.DataFrame(np.random.randn(4,3), columns&#x3D;[&#39;A&#39;,&#39;B&#39;,&#39;C&#39;])</span><br><span class="line">for row_index, row in df.iterrows():</span><br><span class="line">    print(&#39;行 index 是:&#39;, row_index)</span><br><span class="line">    print(row)</span><br><span class="line">    print(&#39;\n&#39;)</span><br><span class="line">行 index 是: 0</span><br><span class="line">A   -0.831008</span><br><span class="line">B   -0.864205</span><br><span class="line">C    0.146520</span><br><span class="line">Name: 0, dtype: float64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">行 index 是: 1</span><br><span class="line">A   -0.991669</span><br><span class="line">B   -2.374277</span><br><span class="line">C   -0.356669</span><br><span class="line">Name: 1, dtype: float64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">行 index 是: 2</span><br><span class="line">A    2.209128</span><br><span class="line">B   -0.420584</span><br><span class="line">C    0.506585</span><br><span class="line">Name: 2, dtype: float64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">行 index 是: 3</span><br><span class="line">A   -1.058109</span><br><span class="line">B   -0.000286</span><br><span class="line">C    1.033392</span><br><span class="line">Name: 3, dtype: float64</span><br></pre></td></tr></table></figure>
<h4 id="3-5-3-DataFrame-itertuples"><a href="#3-5-3-DataFrame-itertuples" class="headerlink" title="3.5.3 DataFrame.itertuples()"></a>3.5.3 DataFrame.itertuples()</h4><p><code>itertuples()</code>方法将为<code>DataFrame</code>中的每一行返回一个产生一个命名元组的迭代器. 元组的第一个元素将是行的相应索引值, 而剩余的值是行值.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">4</span>,<span class="number">3</span>), columns=[<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>])</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> df.itertuples():</span><br><span class="line">    print(row)</span><br><span class="line">    print(<span class="string">&#x27;行 index 是:&#x27;</span>, row[<span class="number">0</span>])</span><br><span class="line">    print(<span class="string">&#x27;行的值是:&#x27;</span>)</span><br><span class="line">    print(row[<span class="number">1</span>:])</span><br><span class="line">    print(<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Pandas(Index&#x3D;0, A&#x3D;-0.3540071641471044, B&#x3D;1.6031505884204515, C&#x3D;-0.4870924983750079)</span><br><span class="line">行 index 是: 0</span><br><span class="line">行的值是:</span><br><span class="line">(-0.3540071641471044, 1.6031505884204515, -0.4870924983750079)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Pandas(Index&#x3D;1, A&#x3D;0.5879313227987284, B&#x3D;-0.5026893763858423, C&#x3D;0.6591968909105315)</span><br><span class="line">行 index 是: 1</span><br><span class="line">行的值是:</span><br><span class="line">(0.5879313227987284, -0.5026893763858423, 0.6591968909105315)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Pandas(Index&#x3D;2, A&#x3D;-1.8100048151441157, B&#x3D;0.7800415414210258, C&#x3D;-0.47082706870345153)</span><br><span class="line">行 index 是: 2</span><br><span class="line">行的值是:</span><br><span class="line">(-1.8100048151441157, 0.7800415414210258, -0.47082706870345153)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Pandas(Index&#x3D;3, A&#x3D;0.22830697450955625, B&#x3D;-0.6997787075277464, C&#x3D;1.6736471725117756)</span><br><span class="line">行 index 是: 3</span><br><span class="line">行的值是:</span><br><span class="line">(0.22830697450955625, -0.6997787075277464, 1.6736471725117756)</span><br></pre></td></tr></table></figure>
<h3 id="3-6-Sorting-DataFrame"><a href="#3-6-Sorting-DataFrame" class="headerlink" title="3.6 Sorting DataFrame"></a>3.6 Sorting DataFrame</h3><p><em>Pandas</em>有两种排序方式, 它们分别是:</p>
<ul>
<li>按 index (可以是行, 也可以是列)</li>
<li>按 values</li>
</ul>
<p>我们先创建一个 DataFrame 用于之后的示例.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">10</span>,<span class="number">2</span>),index=[<span class="number">1</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">7</span>],columns=[<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col1&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">       col2      col1</span><br><span class="line">1 -0.270190  0.970122</span><br><span class="line">4 -0.387794  0.023349</span><br><span class="line">6 -0.340047  0.412159</span><br><span class="line">2  0.473514  0.697203</span><br><span class="line">3 -1.062665  0.666765</span><br><span class="line">5 -0.157076  0.810648</span><br><span class="line">9  0.601996  0.700997</span><br><span class="line">8  1.305286  0.591112</span><br><span class="line">0  0.272618 -0.105529</span><br><span class="line">7 -2.122524 -0.613860</span><br></pre></td></tr></table></figure>
<h4 id="3-6-1-DataFrame-sort-index"><a href="#3-6-1-DataFrame-sort-index" class="headerlink" title="3.6.1 DataFrame.sort_index()"></a>3.6.1 DataFrame.sort_index()</h4><p>使用<code>sort_index()</code>方法, 通过传递<code>axis</code>参数和排序顺序, 可以对<code>DataFrame</code>进行排序. 默认情况下, 按照升序对行 index 进行排序.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">10</span>,<span class="number">2</span>),index=[<span class="number">1</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">7</span>],columns=[<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col1&#x27;</span>])</span><br><span class="line"></span><br><span class="line">asc_sorted_df = df.sort_index(axis=<span class="number">0</span>)</span><br><span class="line">desc_sorted_df = df.sort_index(axis=<span class="number">0</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">print(<span class="string">&#x27;升序排序:&#x27;</span>)</span><br><span class="line">print(asc_sorted_df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;降序排序:&#x27;</span>)</span><br><span class="line">print(desc_sorted_df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">升序排序:</span><br><span class="line">       col2      col1</span><br><span class="line">0  0.509889 -0.863155</span><br><span class="line">1  0.717766 -0.865105</span><br><span class="line">2 -1.465073  0.501439</span><br><span class="line">3 -0.891743 -0.772799</span><br><span class="line">4 -1.086885  0.241132</span><br><span class="line">5  0.104040  1.564791</span><br><span class="line">6 -1.271712  0.074772</span><br><span class="line">7  0.772256 -0.880302</span><br><span class="line">8 -0.361009 -0.391085</span><br><span class="line">9  0.255575  0.506795</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">降序排序:</span><br><span class="line">       col2      col1</span><br><span class="line">9  0.255575  0.506795</span><br><span class="line">8 -0.361009 -0.391085</span><br><span class="line">7  0.772256 -0.880302</span><br><span class="line">6 -1.271712  0.074772</span><br><span class="line">5  0.104040  1.564791</span><br><span class="line">4 -1.086885  0.241132</span><br><span class="line">3 -0.891743 -0.772799</span><br><span class="line">2 -1.465073  0.501439</span><br><span class="line">1  0.717766 -0.865105</span><br><span class="line">0  0.509889 -0.863155</span><br></pre></td></tr></table></figure>
<p><strong>我们再看一下按列排序的情况</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">10</span>,<span class="number">2</span>),index=[<span class="number">1</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">7</span>],columns=[<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col1&#x27;</span>])</span><br><span class="line"></span><br><span class="line">asc_sorted_df = df.sort_index(axis=<span class="number">1</span>)</span><br><span class="line">desc_sorted_df = df.sort_index(axis=<span class="number">1</span>, ascending=<span class="literal">False</span>)</span><br><span class="line">print(<span class="string">&#x27;升序排序:&#x27;</span>)</span><br><span class="line">print(asc_sorted_df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;降序排序:&#x27;</span>)</span><br><span class="line">print(desc_sorted_df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">升序排序:</span><br><span class="line">       col1      col2</span><br><span class="line">1 -0.482662  1.857978</span><br><span class="line">4  1.008759  0.157484</span><br><span class="line">6  0.404661  0.084503</span><br><span class="line">2 -0.350703  0.340782</span><br><span class="line">3 -0.577663 -0.453446</span><br><span class="line">5  0.136501 -1.253516</span><br><span class="line">9  0.893234 -0.239606</span><br><span class="line">8  1.246226 -0.945827</span><br><span class="line">0  0.322587 -2.122998</span><br><span class="line">7 -2.055323  0.208008</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">降序排序:</span><br><span class="line">       col2      col1</span><br><span class="line">1  1.857978 -0.482662</span><br><span class="line">4  0.157484  1.008759</span><br><span class="line">6  0.084503  0.404661</span><br><span class="line">2  0.340782 -0.350703</span><br><span class="line">3 -0.453446 -0.577663</span><br><span class="line">5 -1.253516  0.136501</span><br><span class="line">9 -0.239606  0.893234</span><br><span class="line">8 -0.945827  1.246226</span><br><span class="line">0 -2.122998  0.322587</span><br><span class="line">7  0.208008 -2.055323</span><br></pre></td></tr></table></figure>
<h4 id="3-6-2-DataFrame-sort-values"><a href="#3-6-2-DataFrame-sort-values" class="headerlink" title="3.6.2 DataFrame.sort_values()"></a>3.6.2 DataFrame.sort_values()</h4><p><code>sort_values()</code>是按值排序的方法. 它接受一个<code>by</code>参数, 它将使用要与其排序值的<code>DataFrame</code>的列名称.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">10</span>,<span class="number">2</span>),index=[<span class="number">1</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">7</span>],columns=[<span class="string">&#x27;col2&#x27;</span>,<span class="string">&#x27;col1&#x27;</span>])</span><br><span class="line"></span><br><span class="line">sorted_df = df.sort_index(axis=<span class="number">1</span>).sort_values(by=[<span class="string">&#x27;col1&#x27;</span>,<span class="string">&#x27;col2&#x27;</span>],kind=<span class="string">&#x27;mergesort&#x27;</span>,ascending=<span class="literal">False</span>)</span><br><span class="line">print(<span class="string">&#x27;排序结果是:&#x27;</span>)</span><br><span class="line">print(sorted_df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">排序结果是:</span><br><span class="line">       col1      col2</span><br><span class="line">2  1.643330  0.634745</span><br><span class="line">7  1.424638 -0.712359</span><br><span class="line">8  1.091883  0.342883</span><br><span class="line">4  1.047769 -0.215468</span><br><span class="line">5  0.432504 -3.370203</span><br><span class="line">9  0.134519  0.829283</span><br><span class="line">6 -0.001631 -1.385783</span><br><span class="line">3 -0.775563  0.302277</span><br><span class="line">0 -1.370623 -0.091588</span><br><span class="line">1 -1.941154 -0.107553</span><br></pre></td></tr></table></figure>
<h3 id="3-7-Date-Function"><a href="#3-7-Date-Function" class="headerlink" title="3.7 Date Function"></a>3.7 Date Function</h3><p>日期功能扩展了时间序列, 在财务数据分析中起主要作用. 在处理日期数据的同时, 我们经常会遇到以下情况:</p>
<ul>
<li>生成日期序列</li>
<li>将日期序列转换为不同的频率</li>
</ul>
<h4 id="3-7-1-pandas-date-range"><a href="#3-7-1-pandas-date-range" class="headerlink" title="3.7.1 pandas.date_range()"></a>3.7.1 pandas.date_range()</h4><p><strong>通过指定周期和频率, 使用<code>date.range()</code>函数就可以创建日期序列. 默认情况下, 范围的频率是天.</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">datelist = pd.date_range(<span class="string">&#x27;2020/11/21&#x27;</span>,periods=<span class="number">5</span>)</span><br><span class="line">print(datelist)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DatetimeIndex([&#39;2020-11-21&#39;, &#39;2020-11-22&#39;, &#39;2020-11-23&#39;, &#39;2020-11-24&#39;,</span><br><span class="line">               &#39;2020-11-25&#39;],</span><br><span class="line">              dtype&#x3D;&#39;datetime64[ns]&#39;, freq&#x3D;&#39;D&#39;)</span><br></pre></td></tr></table></figure>
<p><strong>我们可以更改日期频率为月</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">datelist = pd.date_range(<span class="string">&#x27;2020/11/21&#x27;</span>,periods=<span class="number">5</span>, freq=<span class="string">&#x27;M&#x27;</span>)</span><br><span class="line">print(datelist)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DatetimeIndex([&#39;2020-11-30&#39;, &#39;2020-12-31&#39;, &#39;2021-01-31&#39;, &#39;2021-02-28&#39;,</span><br><span class="line">               &#39;2021-03-31&#39;],</span><br><span class="line">              dtype&#x3D;&#39;datetime64[ns]&#39;, freq&#x3D;&#39;M&#39;)</span><br></pre></td></tr></table></figure>
<h4 id="3-7-2-pandas-bdate-range"><a href="#3-7-2-pandas-bdate-range" class="headerlink" title="3.7.2 pandas.bdate_range()"></a>3.7.2 pandas.bdate_range()</h4><p><code>bdate_range()</code>用来表示商业日期范围, 不同于<code>date_range()</code>, 它不包括星期六和星期天.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">start = pd.datetime(<span class="number">2020</span>,<span class="number">8</span>,<span class="number">21</span>)</span><br><span class="line">end = pd.datetime(<span class="number">2020</span>,<span class="number">8</span>,<span class="number">29</span>)</span><br><span class="line">datelist = pd.bdate_range(start,end)</span><br><span class="line">print(datelist)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DatetimeIndex([&#39;2020-08-21&#39;, &#39;2020-08-24&#39;, &#39;2020-08-25&#39;, &#39;2020-08-26&#39;,</span><br><span class="line">               &#39;2020-08-27&#39;, &#39;2020-08-28&#39;],</span><br><span class="line">              dtype&#x3D;&#39;datetime64[ns]&#39;, freq&#x3D;&#39;B&#39;)</span><br></pre></td></tr></table></figure>
<p><strong>参数 <code>freq</code> 可以有以下选择:</strong></p>
<p><img src="https://i.loli.net/2020/08/21/OIkd4VeKgPZnRAM.png" alt="image-20200821192822274" style="zoom:50%;" /></p>
<h4 id="3-7-3-pandas-Timedelta"><a href="#3-7-3-pandas-Timedelta" class="headerlink" title="3.7.3 pandas.Timedelta()"></a>3.7.3 pandas.Timedelta()</h4><p>时间差(Timedelta)是时间上的差异, 以不同的单位来表示. 例如：日, 小时, 分钟, 秒. 它们可以是正值, 也可以是负值.<br>可以使用各种参数创建<code>Timedelta</code>对象, 如下所示:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">timediff = pd.Timedelta(<span class="string">&#x27;2 days 2 hours 15 minues 30 seconds&#x27;</span>)</span><br><span class="line">print(timediff)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2 days 02:15:30</span><br></pre></td></tr></table></figure>
<p>以在Series/DataFrames上执行运算操作, 并通过在 <code>datetime64 [ns]</code> 系列或在时间戳上减法操作来构造 <code>timedelta64 [ns]</code> 系列.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series(pd.date_range(<span class="string">&#x27;2012-1-1&#x27;</span>, periods=<span class="number">3</span>, freq=<span class="string">&#x27;D&#x27;</span>))</span><br><span class="line">tdiff = pd.Series([pd.Timedelta(days=i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)])</span><br><span class="line">df = pd.DataFrame(<span class="built_in">dict</span>(A=s,B=tdiff))</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">df[<span class="string">&#x27;A+B&#x27;</span>] = df[<span class="string">&#x27;A&#x27;</span>] + df[<span class="string">&#x27;B&#x27;</span>]</span><br><span class="line">df[<span class="string">&#x27;A-B&#x27;</span>] = df[<span class="string">&#x27;A&#x27;</span>] - df[<span class="string">&#x27;B&#x27;</span>]</span><br><span class="line">print(<span class="string">&#x27;修改后的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">           A      B</span><br><span class="line">0 2012-01-01 0 days</span><br><span class="line">1 2012-01-02 1 days</span><br><span class="line">2 2012-01-03 2 days</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">修改后的数据是:</span><br><span class="line">           A      B        A+B        A-B</span><br><span class="line">0 2012-01-01 0 days 2012-01-01 2012-01-01</span><br><span class="line">1 2012-01-02 1 days 2012-01-03 2012-01-01</span><br><span class="line">2 2012-01-03 2 days 2012-01-05 2012-01-01</span><br></pre></td></tr></table></figure>
<h3 id="3-8-Categorical-Data"><a href="#3-8-Categorical-Data" class="headerlink" title="3.8 Categorical Data"></a>3.8 Categorical Data</h3><p><strong>分类数据 (Categorical Data)</strong> 用于表示统计学里<strong>有限且唯一性数据集</strong>, 例如描述个人信息的性别一般就男和女两个数据常用’m’和’f’来描述, 有时也能对应编码映射为0和1. 血型A、B、O和AB型等选择可以映射为0、1、2、3这四个数字分别代表各个血型. Pandas 里直接就有 categorical 类型, 可以有效地对数据进行分组进行相应的汇总统计工作.</p>
<h4 id="3-8-1-Object-Creation"><a href="#3-8-1-Object-Creation" class="headerlink" title="3.8.1 Object Creation"></a>3.8.1 Object Creation</h4><p>分类对象可以通过多种方式创建:</p>
<ol>
<li><p>通过在<code>pandas</code>对象创建中将<code>dtype</code>指定为<code>“category”</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>], dtype=<span class="string">&#x27;category&#x27;</span>)</span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">0    a</span><br><span class="line">1    b</span><br><span class="line">2    c</span><br><span class="line">3    d</span><br><span class="line">dtype: category</span><br><span class="line">Categories (4, object): [a, b, c, d]</span><br></pre></td></tr></table></figure></li>
<li><p>使用标准 <strong>Pandas</strong> 分类构造函数: <code>pandas.Categorical()</code>. 我们可以创建一个类别对象, 语法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pandas.Categorical(values, categories, ordered)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># values: 传入的数据</span></span><br><span class="line"><span class="comment"># categories: 数据的分类, 在类别中不存在的任何值将被视为NaN</span></span><br><span class="line"><span class="comment"># ordered: bool, 是否进行逻辑排序, 按 categories 里面的顺序从小到达</span></span><br></pre></td></tr></table></figure>
<p>看个例子</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">cat = pd.Categorical(values=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>],categories=[<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;a&#x27;</span>],ordered=<span class="literal">True</span>)</span><br><span class="line">print(cat)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[a, b, c, d, NaN]</span><br><span class="line">Categories (4, object): [d &lt; b &lt; c &lt; a]</span><br></pre></td></tr></table></figure>
<h4 id="3-8-2-Reading-Categorical-Data"><a href="#3-8-2-Reading-Categorical-Data" class="headerlink" title="3.8.2 Reading Categorical Data"></a>3.8.2 Reading Categorical Data</h4></li>
</ol>
<p><strong>我们可以对分类数据使用 <code>.describe()</code> , 得到各类数据出现的次数和频率</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">cat = pd.Categorical([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;a&#x27;</span>],categories=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>],ordered=<span class="literal">False</span>)</span><br><span class="line">cat.describe()</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/23/TaMvgte5uJ3qQDY.png" alt="image-20200823164719200" style="zoom:50%;" /></p>
<p><strong>我们可以使用 <code>.categories</code> 访问对象的类别, 以及使用 <code>.ordered</code> 看数据是否有排序.</strong></p>
<p><strong>我们还能使用 <code>Categorical.categories</code> 来修改对象的类别</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">cat = pd.Categorical([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;a&#x27;</span>],categories=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>],ordered=<span class="literal">False</span>)</span><br><span class="line">print(<span class="string">&#x27;我们的原数据是:&#x27;</span>)</span><br><span class="line">print(cat)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;修改数据类别&#x27;</span>)</span><br><span class="line">cat.categories = [<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;e&#x27;</span>]  <span class="comment"># 原来的 b 变成 c, c 变成 e</span></span><br><span class="line">print(cat)</span><br></pre></td></tr></table></figure>
<p>输出结果是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">我们的原数据是:</span><br><span class="line">[a, c, a, b, c, b, a]</span><br><span class="line">Categories (3, object): [a, b, c]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">修改数据类别</span><br><span class="line">[a, e, a, c, e, c, a]</span><br><span class="line">Categories (3, object): [a, c, e]</span><br></pre></td></tr></table></figure>
<h4 id="3-8-3-Categorical-Data-Operations"><a href="#3-8-3-Categorical-Data-Operations" class="headerlink" title="3.8.3 Categorical Data Operations"></a>3.8.3 Categorical Data Operations</h4><ol>
<li><p>Adding Categories</p>
<p>使用<code>Categorical.add.categories()</code>方法, 可以追加新的类别.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;a&#x27;</span>],dtype=<span class="string">&#x27;category&#x27;</span>)</span><br><span class="line">s = s.cat.add_categories([<span class="string">&#x27;d&#x27;</span>])</span><br><span class="line">print(s.cat.categories)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Index([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;], dtype&#x3D;&#39;object&#39;)</span><br></pre></td></tr></table></figure></li>
<li><p>Removing Categories</p>
<p>使用<code>Categorical.remove_categories()</code>方法, 可以删除不需要的类别.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">s = pd.Series([<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;a&#x27;</span>],dtype=<span class="string">&#x27;category&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;我们原数据是:&#x27;</span>)</span><br><span class="line">print(s)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;移除类别后:&#x27;</span>)</span><br><span class="line">print(s.cat.remove_categories([<span class="string">&#x27;a&#x27;</span>]))</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">我们原数据是:</span><br><span class="line">0    a</span><br><span class="line">1    b</span><br><span class="line">2    c</span><br><span class="line">3    a</span><br><span class="line">dtype: category</span><br><span class="line">Categories (3, object): [a, b, c]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">移除类别后:</span><br><span class="line">0    NaN</span><br><span class="line">1      b</span><br><span class="line">2      c</span><br><span class="line">3    NaN</span><br><span class="line">dtype: category</span><br><span class="line">Categories (2, object): [b, c]</span><br></pre></td></tr></table></figure>
<h2 id="Topic-4-Statistics-Functions"><a href="#Topic-4-Statistics-Functions" class="headerlink" title="Topic 4 Statistics Functions"></a>Topic 4 Statistics Functions</h2></li>
</ol>
<div class="table-container">
<table>
<thead>
<tr>
<th>函数</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>count()</code></td>
<td>每一列或行的非空数据的数量</td>
</tr>
<tr>
<td><code>sum()</code></td>
<td>每一列或行的所有值之和</td>
</tr>
<tr>
<td><code>mean()</code></td>
<td>每一列或行的所有值的平均值</td>
</tr>
<tr>
<td><code>median()</code></td>
<td>每一列或行的所有值的中位数</td>
</tr>
<tr>
<td><code>mode()</code></td>
<td>每一列或行中出现次数最多的数据</td>
</tr>
<tr>
<td><code>std()</code></td>
<td>每一列或行的标准差</td>
</tr>
<tr>
<td><code>min()</code></td>
<td>每一列或行的所有值中的最小值</td>
</tr>
<tr>
<td><code>max()</code></td>
<td>每一列或行的所有值中的最大值</td>
</tr>
<tr>
<td><code>abs()</code></td>
<td>取绝对值, 只适用于所有数值元素.</td>
</tr>
<tr>
<td><code>prod()</code></td>
<td>每一列或行的数组元素的乘积</td>
</tr>
<tr>
<td><code>cumsum()</code></td>
<td>累计总和</td>
</tr>
<tr>
<td><code>cumprod()</code></td>
<td>累计乘积, 只适用于所有数值元素.</td>
</tr>
<tr>
<td><code>var()</code></td>
<td>方差</td>
</tr>
<tr>
<td><code>skew()</code></td>
<td>偏差</td>
</tr>
<tr>
<td><code>kurt()</code></td>
<td>峰度</td>
</tr>
<tr>
<td><code>quantile()</code></td>
<td>分位数</td>
</tr>
<tr>
<td><code>cov()</code></td>
<td>协方差</td>
</tr>
<tr>
<td><code>corr()</code></td>
<td>相关系数</td>
</tr>
</tbody>
</table>
</div>
<h3 id="4-1-DataFrame-count"><a href="#4-1-DataFrame-count" class="headerlink" title="4.1 DataFrame.count()"></a>4.1 DataFrame.count()</h3><p>每一列非空数据的数量, 用法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.count(self, axis=<span class="number">0</span>, numeric_only=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># axis: 0 竖直, 1 水平</span></span><br><span class="line"><span class="comment"># numeric_only: 是否只计算数据类型为数值的数据</span></span><br></pre></td></tr></table></figure>
<p>看个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">d = &#123;<span class="string">&#x27;Name&#x27;</span>:pd.Series([<span class="string">&#x27;Tom&#x27;</span>,<span class="string">&#x27;James&#x27;</span>,<span class="string">&#x27;Ricky&#x27;</span>,<span class="string">&#x27;Vin&#x27;</span>,<span class="string">&#x27;Steve&#x27;</span>,<span class="string">&#x27;Minsu&#x27;</span>,<span class="string">&#x27;Jack&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;Lee&#x27;</span>,<span class="string">&#x27;David&#x27;</span>,<span class="string">&#x27;Gasper&#x27;</span>,<span class="string">&#x27;Betina&#x27;</span>,<span class="string">&#x27;Andres&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;Age&#x27;</span>:pd.Series([<span class="number">25</span>,<span class="number">26</span>,<span class="number">25</span>,<span class="number">23</span>,<span class="number">30</span>,<span class="number">29</span>,<span class="number">23</span>,<span class="number">34</span>,<span class="number">40</span>,<span class="number">30</span>,<span class="number">51</span>,<span class="number">46</span>]),</span><br><span class="line">   <span class="string">&#x27;Rating&#x27;</span>:pd.Series([<span class="number">4.23</span>,<span class="number">3.24</span>,<span class="number">3.98</span>,<span class="number">2.56</span>,<span class="number">3.20</span>,<span class="number">4.6</span>,<span class="number">3.8</span>,<span class="number">3.78</span>,<span class="number">2.98</span>,<span class="number">4.80</span>,<span class="number">4.10</span>,<span class="number">3.65</span>])&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;非空行的数量:&#x27;</span>)</span><br><span class="line">print(df.count())</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">      Name  Age  Rating</span><br><span class="line">0      Tom   25    4.23</span><br><span class="line">1    James   26    3.24</span><br><span class="line">2    Ricky   25    3.98</span><br><span class="line">3      Vin   23    2.56</span><br><span class="line">4    Steve   30    3.20</span><br><span class="line">5    Minsu   29    4.60</span><br><span class="line">6     Jack   23    3.80</span><br><span class="line">7      Lee   34    3.78</span><br><span class="line">8    David   40    2.98</span><br><span class="line">9   Gasper   30    4.80</span><br><span class="line">10  Betina   51    4.10</span><br><span class="line">11  Andres   46    3.65</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">非空行的数量:</span><br><span class="line">Name      12</span><br><span class="line">Age       12</span><br><span class="line">Rating    12</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<h3 id="4-2-DataFrame-sum"><a href="#4-2-DataFrame-sum" class="headerlink" title="4.2 DataFrame.sum()"></a>4.2 DataFrame.sum()</h3><p>返回行或列的数据之和, 用法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.<span class="built_in">sum</span>(self,axis=<span class="literal">None</span>,skipna=<span class="literal">None</span>,numeric_only=<span class="literal">None</span>,min_count=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># axis: 指明沿什么轴计算, 可看我的 numpy 笔记的 Topic 3. 0 是竖直, 1 是水平</span></span><br><span class="line"><span class="comment"># skipna: 是否跳过空数据, 默认为 True</span></span><br><span class="line"><span class="comment"># numeric_only: 是否只计算 int 或 float 的和, 默认为 False</span></span><br><span class="line"><span class="comment"># min_count: 默认为 0, 若该列的有效数据量低于这个值, 则不计算该列的和</span></span><br></pre></td></tr></table></figure>
<p>看个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">d = &#123;<span class="string">&#x27;Name&#x27;</span>:pd.Series([<span class="string">&#x27;Tom&#x27;</span>,<span class="string">&#x27;James&#x27;</span>,<span class="string">&#x27;Ricky&#x27;</span>,<span class="string">&#x27;Vin&#x27;</span>,<span class="string">&#x27;Steve&#x27;</span>,<span class="string">&#x27;Minsu&#x27;</span>,<span class="string">&#x27;Jack&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;Lee&#x27;</span>,<span class="string">&#x27;David&#x27;</span>,<span class="string">&#x27;Gasper&#x27;</span>,<span class="string">&#x27;Betina&#x27;</span>,<span class="string">&#x27;Andres&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;Age&#x27;</span>:pd.Series([<span class="number">25</span>,<span class="number">26</span>,<span class="number">25</span>,<span class="number">23</span>,<span class="number">30</span>,<span class="number">29</span>,<span class="number">23</span>,<span class="number">34</span>,<span class="number">40</span>,<span class="number">30</span>,<span class="number">51</span>,<span class="number">46</span>]),</span><br><span class="line">   <span class="string">&#x27;Rating&#x27;</span>:pd.Series([<span class="number">4.23</span>,<span class="number">3.24</span>,<span class="number">3.98</span>,<span class="number">2.56</span>,<span class="number">3.20</span>,<span class="number">4.6</span>,<span class="number">3.8</span>,<span class="number">3.78</span>,<span class="number">2.98</span>,<span class="number">4.80</span>,<span class="number">4.10</span>,<span class="number">3.65</span>])&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;数据类型是数值的列之和:&#x27;</span>)</span><br><span class="line">print(df.<span class="built_in">sum</span>(numeric_only=<span class="literal">True</span>,axis=<span class="number">0</span>))</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">      Name  Age  Rating</span><br><span class="line">0      Tom   25    4.23</span><br><span class="line">1    James   26    3.24</span><br><span class="line">2    Ricky   25    3.98</span><br><span class="line">3      Vin   23    2.56</span><br><span class="line">4    Steve   30    3.20</span><br><span class="line">5    Minsu   29    4.60</span><br><span class="line">6     Jack   23    3.80</span><br><span class="line">7      Lee   34    3.78</span><br><span class="line">8    David   40    2.98</span><br><span class="line">9   Gasper   30    4.80</span><br><span class="line">10  Betina   51    4.10</span><br><span class="line">11  Andres   46    3.65</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">数据类型是数值的列之和:</span><br><span class="line">Age       382.00</span><br><span class="line">Rating     44.92</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<h3 id="4-3-DataFrame-mean"><a href="#4-3-DataFrame-mean" class="headerlink" title="4.3 DataFrame.mean()"></a>4.3 DataFrame.mean()</h3><p>返回数据的平均值, 用法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.mean(axis=<span class="literal">None</span>,skipna=<span class="literal">None</span>,numeric_only=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p><code>DataFrame.median()</code>, <code>DataFrame.std()</code>, <code>DataFrame.min()</code> , <code>DataFrame.max()</code> 以及 <code>DataFrame.prod()</code> …. 的用法与之相同, 我就不再赘述了.</p>
<p>看个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">d = &#123;<span class="string">&#x27;Name&#x27;</span>:pd.Series([<span class="string">&#x27;Tom&#x27;</span>,<span class="string">&#x27;James&#x27;</span>,<span class="string">&#x27;Ricky&#x27;</span>,<span class="string">&#x27;Vin&#x27;</span>,<span class="string">&#x27;Steve&#x27;</span>,<span class="string">&#x27;Minsu&#x27;</span>,<span class="string">&#x27;Jack&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;Lee&#x27;</span>,<span class="string">&#x27;David&#x27;</span>,<span class="string">&#x27;Gasper&#x27;</span>,<span class="string">&#x27;Betina&#x27;</span>,<span class="string">&#x27;Andres&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;Age&#x27;</span>:pd.Series([<span class="number">25</span>,<span class="number">26</span>,<span class="number">25</span>,<span class="number">23</span>,<span class="number">30</span>,<span class="number">29</span>,<span class="number">23</span>,<span class="number">34</span>,<span class="number">40</span>,<span class="number">30</span>,<span class="number">51</span>,<span class="number">46</span>]),</span><br><span class="line">   <span class="string">&#x27;Rating&#x27;</span>:pd.Series([<span class="number">4.23</span>,<span class="number">3.24</span>,<span class="number">3.98</span>,<span class="number">2.56</span>,<span class="number">3.20</span>,<span class="number">4.6</span>,<span class="number">3.8</span>,<span class="number">3.78</span>,<span class="number">2.98</span>,<span class="number">4.80</span>,<span class="number">4.10</span>,<span class="number">3.65</span>])&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;每列的平均值是:&#x27;</span>)</span><br><span class="line">print(df.mean())</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">      Name  Age  Rating</span><br><span class="line">0      Tom   25    4.23</span><br><span class="line">1    James   26    3.24</span><br><span class="line">2    Ricky   25    3.98</span><br><span class="line">3      Vin   23    2.56</span><br><span class="line">4    Steve   30    3.20</span><br><span class="line">5    Minsu   29    4.60</span><br><span class="line">6     Jack   23    3.80</span><br><span class="line">7      Lee   34    3.78</span><br><span class="line">8    David   40    2.98</span><br><span class="line">9   Gasper   30    4.80</span><br><span class="line">10  Betina   51    4.10</span><br><span class="line">11  Andres   46    3.65</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">每列的平均值是:</span><br><span class="line">Age       31.833333</span><br><span class="line">Rating     3.743333</span><br><span class="line">dtype: float64</span><br></pre></td></tr></table></figure>
<h3 id="4-4-DataFrame-mode"><a href="#4-4-DataFrame-mode" class="headerlink" title="4.4 DataFrame.mode()"></a>4.4 DataFrame.mode()</h3><p>每一列或行中出现次数最多的数据, 用法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.mode(self, axis=<span class="number">0</span>, numeric_only=<span class="literal">False</span>, dropna=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># axis: 0 获取各列的 mode, 1 获取各行的 mode</span></span><br><span class="line"><span class="comment"># numeric_only: 若为 True, 那么只适用于数字列</span></span><br><span class="line"><span class="comment"># dropna: 是否考虑 na 值</span></span><br></pre></td></tr></table></figure>
<p>看个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame([(<span class="string">&#x27;bird&#x27;</span>, <span class="number">2</span>, <span class="number">2</span>),</span><br><span class="line">                   (<span class="string">&#x27;mammal&#x27;</span>, <span class="number">4</span>, np.nan),</span><br><span class="line">                   (<span class="string">&#x27;arthropod&#x27;</span>, <span class="number">8</span>, <span class="number">0</span>),</span><br><span class="line">                   (<span class="string">&#x27;bird&#x27;</span>, <span class="number">2</span>, np.nan)],</span><br><span class="line">                  index=(<span class="string">&#x27;falcon&#x27;</span>, <span class="string">&#x27;horse&#x27;</span>, <span class="string">&#x27;spider&#x27;</span>, <span class="string">&#x27;ostrich&#x27;</span>),</span><br><span class="line">                  columns=(<span class="string">&#x27;species&#x27;</span>, <span class="string">&#x27;legs&#x27;</span>, <span class="string">&#x27;wings&#x27;</span>))</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;dropna 情况下, 每列的 mode:&#x27;</span>)</span><br><span class="line">print(df.mode())</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;不 dropna 的情况下, 每列的 mode:&#x27;</span>)</span><br><span class="line">print(df.mode(dropna=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">           species  legs  wings</span><br><span class="line">falcon        bird     2    2.0</span><br><span class="line">horse       mammal     4    NaN</span><br><span class="line">spider   arthropod     8    0.0</span><br><span class="line">ostrich       bird     2    NaN</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dropna 情况下, 每列的 mode:</span><br><span class="line">  species  legs  wings</span><br><span class="line">0    bird   2.0    0.0</span><br><span class="line">1     NaN   NaN    2.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">不 dropna 的情况下, 每列的 mode:</span><br><span class="line">  species  legs  wings</span><br><span class="line">0    bird     2    NaN</span><br></pre></td></tr></table></figure>
<h3 id="4-5-DataFrame-abs"><a href="#4-5-DataFrame-abs" class="headerlink" title="4.5 DataFrame.abs()"></a>4.5 DataFrame.abs()</h3><p>返回一个包含每个元素绝对值的<code>Series</code>/<code>DataFrame</code>. 此函数只适用于所有数值元素.</p>
<p>看个列子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;a&#x27;</span>: [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>],<span class="string">&#x27;b&#x27;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>],<span class="string">&#x27;c&#x27;</span>: [<span class="number">100</span>, <span class="number">50</span>, -<span class="number">30</span>, -<span class="number">50</span>]&#125;)</span><br><span class="line">      </span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;取绝对值之后的数据:&#x27;</span>)</span><br><span class="line">print(df.<span class="built_in">abs</span>())</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">   a   b    c</span><br><span class="line">0  4  10  100</span><br><span class="line">1  5  20   50</span><br><span class="line">2  6  30  -30</span><br><span class="line">3  7  40  -50</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">取绝对值之后的数据:</span><br><span class="line">   a   b    c</span><br><span class="line">0  4  10  100</span><br><span class="line">1  5  20   50</span><br><span class="line">2  6  30   30</span><br><span class="line">3  7  40   50</span><br></pre></td></tr></table></figure>
<h3 id="4-6-DataFrame-cumsum-amp-DataFrame-cumprod"><a href="#4-6-DataFrame-cumsum-amp-DataFrame-cumprod" class="headerlink" title="4.6 DataFrame.cumsum() &amp; DataFrame.cumprod()"></a>4.6 DataFrame.cumsum() &amp; DataFrame.cumprod()</h3><p>返回DataFrame或Series轴上的累计和/积</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;a&#x27;</span>: [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>],<span class="string">&#x27;b&#x27;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>],<span class="string">&#x27;c&#x27;</span>: [<span class="number">100</span>, <span class="number">50</span>, -<span class="number">30</span>, -<span class="number">50</span>]&#125;)</span><br><span class="line">      </span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;沿轴 0 累计的和:&#x27;</span>)</span><br><span class="line">print(df.cumsum())</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;沿轴 0 累计的积:&#x27;</span>)</span><br><span class="line">print(df.cumprod())</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">   a   b    c</span><br><span class="line">0  4  10  100</span><br><span class="line">1  5  20   50</span><br><span class="line">2  6  30  -30</span><br><span class="line">3  7  40  -50</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">沿轴 0 累计的和:</span><br><span class="line">    a    b    c</span><br><span class="line">0   4   10  100</span><br><span class="line">1   9   30  150</span><br><span class="line">2  15   60  120</span><br><span class="line">3  22  100   70</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">沿轴 0 累计的积:</span><br><span class="line">     a       b        c</span><br><span class="line">0    4      10      100</span><br><span class="line">1   20     200     5000</span><br><span class="line">2  120    6000  -150000</span><br><span class="line">3  840  240000  7500000</span><br></pre></td></tr></table></figure>
<h3 id="4-7-DataFrame-describe"><a href="#4-7-DataFrame-describe" class="headerlink" title="4.7 DataFrame.describe()"></a>4.7 DataFrame.describe()</h3><p>描述性统计归纳总计</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">d = &#123;<span class="string">&#x27;Name&#x27;</span>:pd.Series([<span class="string">&#x27;Tom&#x27;</span>,<span class="string">&#x27;James&#x27;</span>,<span class="string">&#x27;Ricky&#x27;</span>,<span class="string">&#x27;Vin&#x27;</span>,<span class="string">&#x27;Steve&#x27;</span>,<span class="string">&#x27;Minsu&#x27;</span>,<span class="string">&#x27;Jack&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;Lee&#x27;</span>,<span class="string">&#x27;David&#x27;</span>,<span class="string">&#x27;Gasper&#x27;</span>,<span class="string">&#x27;Betina&#x27;</span>,<span class="string">&#x27;Andres&#x27;</span>]),</span><br><span class="line">   <span class="string">&#x27;Age&#x27;</span>:pd.Series([<span class="number">25</span>,<span class="number">26</span>,<span class="number">25</span>,<span class="number">23</span>,<span class="number">30</span>,<span class="number">29</span>,<span class="number">23</span>,<span class="number">34</span>,<span class="number">40</span>,<span class="number">30</span>,<span class="number">51</span>,<span class="number">46</span>]),</span><br><span class="line">   <span class="string">&#x27;Rating&#x27;</span>:pd.Series([<span class="number">4.23</span>,<span class="number">3.24</span>,<span class="number">3.98</span>,<span class="number">2.56</span>,<span class="number">3.20</span>,<span class="number">4.6</span>,<span class="number">3.8</span>,<span class="number">3.78</span>,<span class="number">2.98</span>,<span class="number">4.80</span>,<span class="number">4.10</span>,<span class="number">3.65</span>])&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(d)</span><br><span class="line"></span><br><span class="line">print(df.describe())</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">             Age     Rating</span><br><span class="line">count  12.000000  12.000000</span><br><span class="line">mean   31.833333   3.743333</span><br><span class="line">std     9.232682   0.661628</span><br><span class="line">min    23.000000   2.560000</span><br><span class="line">25%    25.000000   3.230000</span><br><span class="line">50%    29.500000   3.790000</span><br><span class="line">75%    35.500000   4.132500</span><br><span class="line">max    51.000000   4.800000</span><br></pre></td></tr></table></figure>
<h3 id="4-8-DataFrame-pct-change"><a href="#4-8-DataFrame-pct-change" class="headerlink" title="4.8 DataFrame.pct_change()"></a>4.8 DataFrame.pct_change()</h3><p>Series, DatFrames和Panel都有<code>pct_change()</code>函数, 此函数将每个元素与其前一个元素进行比较, 并计算变化百分比.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">s = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span> (s.pct_change())</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(np.random.randn(<span class="number">5</span>, <span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span> (df.pct_change())</span><br></pre></td></tr></table></figure>
<p>输出结果为:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">0         NaN</span><br><span class="line">1    1.000000</span><br><span class="line">2    0.500000</span><br><span class="line">3    0.333333</span><br><span class="line">4    0.250000</span><br><span class="line">5   -0.200000</span><br><span class="line">dtype: float64</span><br><span class="line">          0           1</span><br><span class="line">0       NaN         NaN</span><br><span class="line">1  0.384032   -0.996141</span><br><span class="line">2 -1.736876  679.793981</span><br><span class="line">3  1.063848   -0.441469</span><br><span class="line">4 -1.060066   -1.576158</span><br></pre></td></tr></table></figure>
<h3 id="4-9-DataFrame-sample"><a href="#4-9-DataFrame-sample" class="headerlink" title="4.9 DataFrame.sample()"></a>4.9 DataFrame.sample()</h3><p>从对象轴返回随机的项目样本, 用法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.sample(n=<span class="literal">None</span>,axis=<span class="literal">None</span>,frac=<span class="literal">None</span>,replace=<span class="literal">False</span>,weights=<span class="literal">None</span>,random_state=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># n: 想要取得的样本数, 不能和 frac 一起使用, 若 frac=None, 则 n 默认值为 1</span></span><br><span class="line"><span class="comment"># axis: 沿什么轴抽样</span></span><br><span class="line"><span class="comment"># frac: 取百分之几的数据, 不能与 n 一起使用</span></span><br><span class="line"><span class="comment"># replace: bool, 默认为 False. 允许或不允许对同一行进行多次抽样</span></span><br><span class="line"><span class="comment"># weights: 默认的 None 将导致相等的概率权重.</span></span><br><span class="line"><span class="comment"># random_state: 实现重现性</span></span><br></pre></td></tr></table></figure>
<p>看个例子:</p>
<p>选取数据的 200% 作为样本, 且允许随机抽样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;num_legs&#x27;</span>: [<span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">0</span>],</span><br><span class="line">                 <span class="string">&#x27;num_wings&#x27;</span>: [<span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">                 <span class="string">&#x27;num_specimen_seen&#x27;</span>: [<span class="number">10</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">8</span>]&#125;,</span><br><span class="line">                 index=[<span class="string">&#x27;falcon&#x27;</span>, <span class="string">&#x27;dog&#x27;</span>, <span class="string">&#x27;spider&#x27;</span>, <span class="string">&#x27;fish&#x27;</span>])</span><br><span class="line"></span><br><span class="line">sample = df.sample(frac=<span class="number">2</span>, replace=<span class="literal">True</span>, random_state=<span class="number">1</span>)</span><br><span class="line">print(<span class="string">&#x27;我们的样本是:&#x27;</span>)</span><br><span class="line">print(sample)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">我们的样本是:</span><br><span class="line">        num_legs  num_wings  num_specimen_seen</span><br><span class="line">dog            4          0                  2</span><br><span class="line">fish           0          0                  8</span><br><span class="line">falcon         2          2                 10</span><br><span class="line">falcon         2          2                 10</span><br><span class="line">fish           0          0                  8</span><br><span class="line">dog            4          0                  2</span><br><span class="line">fish           0          0                  8</span><br><span class="line">dog            4          0                  2</span><br></pre></td></tr></table></figure>
<p>使用DataFrame列作为权重. num_specimen_seen列中值较大的行更可能被采样.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;num_legs&#x27;</span>: [<span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">0</span>],</span><br><span class="line">                 <span class="string">&#x27;num_wings&#x27;</span>: [<span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">                 <span class="string">&#x27;num_specimen_seen&#x27;</span>: [<span class="number">10</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">8</span>]&#125;,</span><br><span class="line">                 index=[<span class="string">&#x27;falcon&#x27;</span>, <span class="string">&#x27;dog&#x27;</span>, <span class="string">&#x27;spider&#x27;</span>, <span class="string">&#x27;fish&#x27;</span>])</span><br><span class="line"></span><br><span class="line">sample = df.sample(frac=<span class="number">2</span>, replace=<span class="literal">True</span>, weights=<span class="string">&#x27;num_specimen_seen&#x27;</span>, random_state=<span class="number">1</span>)</span><br><span class="line">print(<span class="string">&#x27;我们的样本是:&#x27;</span>)</span><br><span class="line">print(sample)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">我们的样本是:</span><br><span class="line">        num_legs  num_wings  num_specimen_seen</span><br><span class="line">falcon         2          2                 10</span><br><span class="line">fish           0          0                  8</span><br><span class="line">falcon         2          2                 10</span><br><span class="line">falcon         2          2                 10</span><br><span class="line">falcon         2          2                 10</span><br><span class="line">falcon         2          2                 10</span><br><span class="line">falcon         2          2                 10</span><br><span class="line">falcon         2          2                 10</span><br></pre></td></tr></table></figure>
<h2 id="Topic-5-Data-Cleaning"><a href="#Topic-5-Data-Cleaning" class="headerlink" title="Topic 5 Data Cleaning"></a>Topic 5 Data Cleaning</h2><p><strong>我们先构造一个包含确实数据的 <code>DataFrame</code>:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = np.arange(<span class="number">10</span>,<span class="number">38</span>).reshape(<span class="number">7</span>,<span class="number">4</span>)</span><br><span class="line">rows = <span class="string">&#x27;cake make fake sake wake lake take&#x27;</span>.split()</span><br><span class="line">cols = <span class="built_in">list</span>(<span class="string">&#x27;abcd&#x27;</span>)</span><br><span class="line">df = pd.DataFrame(data=data, index=rows, columns=cols)</span><br><span class="line">df[<span class="string">&#x27;e&#x27;</span>] = np.nan</span><br><span class="line">df[<span class="string">&#x27;f&#x27;</span>] = np.nan</span><br><span class="line">df.at[<span class="string">&#x27;make&#x27;</span>,<span class="string">&#x27;e&#x27;</span>] = <span class="number">100</span></span><br><span class="line">df.at[<span class="string">&#x27;wake&#x27;</span>,<span class="string">&#x27;e&#x27;</span>] = <span class="number">300</span></span><br><span class="line">df.loc[<span class="string">&#x27;jake&#x27;</span>] =  np.nan</span><br><span class="line">df.at[<span class="string">&#x27;jake&#x27;</span>,<span class="string">&#x27;c&#x27;</span>] = <span class="number">200</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">         a     b      c     d      e   f</span><br><span class="line">cake  10.0  11.0   12.0  13.0    NaN NaN</span><br><span class="line">make  14.0  15.0   16.0  17.0  100.0 NaN</span><br><span class="line">fake  18.0  19.0   20.0  21.0    NaN NaN</span><br><span class="line">sake  22.0  23.0   24.0  25.0    NaN NaN</span><br><span class="line">wake  26.0  27.0   28.0  29.0  300.0 NaN</span><br><span class="line">lake  30.0  31.0   32.0  33.0    NaN NaN</span><br><span class="line">take  34.0  35.0   36.0  37.0    NaN NaN</span><br><span class="line">jake   NaN   NaN  200.0   NaN    NaN NaN</span><br></pre></td></tr></table></figure>
<p><strong>然后, 我们看一下那些列有 NaN 数据:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = np.arange(<span class="number">10</span>,<span class="number">38</span>).reshape(<span class="number">7</span>,<span class="number">4</span>)</span><br><span class="line">rows = <span class="string">&#x27;cake make fake sake wake lake take&#x27;</span>.split()</span><br><span class="line">cols = <span class="built_in">list</span>(<span class="string">&#x27;abcd&#x27;</span>)</span><br><span class="line">df = pd.DataFrame(data=data, index=rows, columns=cols)</span><br><span class="line">df[<span class="string">&#x27;e&#x27;</span>] = np.nan</span><br><span class="line">df[<span class="string">&#x27;f&#x27;</span>] = np.nan</span><br><span class="line">df.at[<span class="string">&#x27;make&#x27;</span>,<span class="string">&#x27;e&#x27;</span>] = <span class="number">100</span></span><br><span class="line">df.at[<span class="string">&#x27;wake&#x27;</span>,<span class="string">&#x27;e&#x27;</span>] = <span class="number">300</span></span><br><span class="line">df.loc[<span class="string">&#x27;jake&#x27;</span>] =  np.nan</span><br><span class="line">df.at[<span class="string">&#x27;jake&#x27;</span>,<span class="string">&#x27;c&#x27;</span>] = <span class="number">200</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;每一列含空数据的情况:&#x27;</span>)</span><br><span class="line">print(df.isnull().<span class="built_in">sum</span>())</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">每一列含空数据的情况:</span><br><span class="line">a    1</span><br><span class="line">b    1</span><br><span class="line">c    0</span><br><span class="line">d    1</span><br><span class="line">e    6</span><br><span class="line">f    8</span><br></pre></td></tr></table></figure>
<h3 id="5-1-Deleting-NaN-Data"><a href="#5-1-Deleting-NaN-Data" class="headerlink" title="5.1 Deleting NaN Data"></a>5.1 Deleting NaN Data</h3><p><strong>我们主要使用 <code>dropna()</code> 函数来删除 NaN 数据, 看个例子:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = np.arange(<span class="number">10</span>,<span class="number">38</span>).reshape(<span class="number">7</span>,<span class="number">4</span>)</span><br><span class="line">rows = <span class="string">&#x27;cake make fake sake wake lake take&#x27;</span>.split()</span><br><span class="line">cols = <span class="built_in">list</span>(<span class="string">&#x27;abcd&#x27;</span>)</span><br><span class="line">df = pd.DataFrame(data=data, index=rows, columns=cols)</span><br><span class="line">df[<span class="string">&#x27;e&#x27;</span>] = np.nan</span><br><span class="line">df[<span class="string">&#x27;f&#x27;</span>] = np.nan</span><br><span class="line">df.at[<span class="string">&#x27;make&#x27;</span>,<span class="string">&#x27;e&#x27;</span>] = <span class="number">100</span></span><br><span class="line">df.at[<span class="string">&#x27;wake&#x27;</span>,<span class="string">&#x27;e&#x27;</span>] = <span class="number">300</span></span><br><span class="line">df.loc[<span class="string">&#x27;jake&#x27;</span>] =  np.nan</span><br><span class="line">df.at[<span class="string">&#x27;jake&#x27;</span>,<span class="string">&#x27;c&#x27;</span>] = <span class="number">200</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df2 = df.dropna()</span><br><span class="line">print(<span class="string">&#x27;删除含 NaN 的行之后的数据:&#x27;</span>)</span><br><span class="line">print(df2)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">         a     b      c     d      e   f</span><br><span class="line">cake  10.0  11.0   12.0  13.0    NaN NaN</span><br><span class="line">make  14.0  15.0   16.0  17.0  100.0 NaN</span><br><span class="line">fake  18.0  19.0   20.0  21.0    NaN NaN</span><br><span class="line">sake  22.0  23.0   24.0  25.0    NaN NaN</span><br><span class="line">wake  26.0  27.0   28.0  29.0  300.0 NaN</span><br><span class="line">lake  30.0  31.0   32.0  33.0    NaN NaN</span><br><span class="line">take  34.0  35.0   36.0  37.0    NaN NaN</span><br><span class="line">jake   NaN   NaN  200.0   NaN    NaN NaN</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">删除含 NaN 的行之后的数据:</span><br><span class="line">Empty DataFrame</span><br><span class="line">Columns: [a, b, c, d, e, f]</span><br><span class="line">Index: []</span><br></pre></td></tr></table></figure>
<p><strong>所有数据都没有了… 这样不是很好, 我们设置 <code>thresh</code> 来设定删除阈值, 看个例子:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = np.arange(<span class="number">10</span>,<span class="number">38</span>).reshape(<span class="number">7</span>,<span class="number">4</span>)</span><br><span class="line">rows = <span class="string">&#x27;cake make fake sake wake lake take&#x27;</span>.split()</span><br><span class="line">cols = <span class="built_in">list</span>(<span class="string">&#x27;abcd&#x27;</span>)</span><br><span class="line">df = pd.DataFrame(data=data, index=rows, columns=cols)</span><br><span class="line">df[<span class="string">&#x27;e&#x27;</span>] = np.nan</span><br><span class="line">df[<span class="string">&#x27;f&#x27;</span>] = np.nan</span><br><span class="line">df.at[<span class="string">&#x27;make&#x27;</span>,<span class="string">&#x27;e&#x27;</span>] = <span class="number">100</span></span><br><span class="line">df.at[<span class="string">&#x27;wake&#x27;</span>,<span class="string">&#x27;e&#x27;</span>] = <span class="number">300</span></span><br><span class="line">df.loc[<span class="string">&#x27;jake&#x27;</span>] =  np.nan</span><br><span class="line">df.at[<span class="string">&#x27;jake&#x27;</span>,<span class="string">&#x27;c&#x27;</span>] = <span class="number">200</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;列上至少有两个非 NaN 的列留下:&#x27;</span>)</span><br><span class="line">df2 = df.dropna(axis=<span class="string">&#x27;columns&#x27;</span>, thresh=<span class="number">2</span>)</span><br><span class="line">print(df2)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">         a     b      c     d      e   f</span><br><span class="line">cake  10.0  11.0   12.0  13.0    NaN NaN</span><br><span class="line">make  14.0  15.0   16.0  17.0  100.0 NaN</span><br><span class="line">fake  18.0  19.0   20.0  21.0    NaN NaN</span><br><span class="line">sake  22.0  23.0   24.0  25.0    NaN NaN</span><br><span class="line">wake  26.0  27.0   28.0  29.0  300.0 NaN</span><br><span class="line">lake  30.0  31.0   32.0  33.0    NaN NaN</span><br><span class="line">take  34.0  35.0   36.0  37.0    NaN NaN</span><br><span class="line">jake   NaN   NaN  200.0   NaN    NaN NaN</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">列上至少有两个非 NaN 的列留下:</span><br><span class="line">         a     b      c     d      e</span><br><span class="line">cake  10.0  11.0   12.0  13.0    NaN</span><br><span class="line">make  14.0  15.0   16.0  17.0  100.0</span><br><span class="line">fake  18.0  19.0   20.0  21.0    NaN</span><br><span class="line">sake  22.0  23.0   24.0  25.0    NaN</span><br><span class="line">wake  26.0  27.0   28.0  29.0  300.0</span><br><span class="line">lake  30.0  31.0   32.0  33.0    NaN</span><br><span class="line">take  34.0  35.0   36.0  37.0    NaN</span><br><span class="line">jake   NaN   NaN  200.0   NaN    NaN</span><br></pre></td></tr></table></figure>
<h3 id="5-2-Filling-NaN-Data"><a href="#5-2-Filling-NaN-Data" class="headerlink" title="5.2 Filling NaN Data"></a>5.2 Filling NaN Data</h3><p>我们主要是用 <code>DataFrame.fillna()</code> 函数对缺失值进行填充, 有这么几种方法:</p>
<ul>
<li><p>使用 0 (或任意值) 填充缺失值</p>
<p><code>df.fillna(0)</code></p>
</li>
<li><p>用一个字符串来代替缺失值</p>
<p><code>df.fillna(&#39;missing&#39;)</code></p>
</li>
<li><p>用前一个数据代替缺失值</p>
<p><code>df.fillna(method=&#39;pad&#39;)</code></p>
</li>
<li><p>用后一个数据替代缺失值, 我们可以设置 limit 参数来限制替代缺失值的次数</p>
<p><code>df.fillna(method=&#39;bfill&#39;, limit=2)</code></p>
</li>
<li><p>我们还可以使用描述性统计量来代替缺失值</p>
<p><code>df.fillna(df.mean())</code></p>
<p>我们还可以指定某一列的描述性统计量来填充所有缺失值</p>
<p><code>df.fillna(df.mean()[&#39;e&#39;])</code></p>
</li>
</ul>
<h3 id="5-3-Deleting-Duplicated-Data"><a href="#5-3-Deleting-Duplicated-Data" class="headerlink" title="5.3 Deleting Duplicated Data"></a>5.3 Deleting Duplicated Data</h3><p>我们可以首先使用 <code>DataFrame.duplicated()</code> 来查看 DataFrame 中是否存在重复的数据. 然后再使用 <code>DataFrame.drop_duplicates()</code> 来移除重复数据. 看个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">fruit = [<span class="string">&quot;apple&quot;</span>, <span class="string">&quot;pearl&quot;</span>, <span class="string">&quot;watermelon&quot;</span>] * <span class="number">4</span></span><br><span class="line">price = [<span class="number">2.50</span>, <span class="number">3.00</span>, <span class="number">2.75</span>] * <span class="number">4</span></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&quot;fruit&quot;</span>: fruit, <span class="string">&quot;price&quot;</span> : price&#125;)</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;查看数据重复情况:&#x27;</span>, df.duplicated().<span class="built_in">sum</span>())</span><br><span class="line">print(df.duplicated())</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;移除重复数据:&#x27;</span>)</span><br><span class="line">print(df.drop_duplicates())</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">         fruit  price</span><br><span class="line">0        apple   2.50</span><br><span class="line">1        pearl   3.00</span><br><span class="line">2   watermelon   2.75</span><br><span class="line">3        apple   2.50</span><br><span class="line">4        pearl   3.00</span><br><span class="line">5   watermelon   2.75</span><br><span class="line">6        apple   2.50</span><br><span class="line">7        pearl   3.00</span><br><span class="line">8   watermelon   2.75</span><br><span class="line">9        apple   2.50</span><br><span class="line">10       pearl   3.00</span><br><span class="line">11  watermelon   2.75</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">查看数据重复情况: 9</span><br><span class="line">0     False</span><br><span class="line">1     False</span><br><span class="line">2     False</span><br><span class="line">3      True</span><br><span class="line">4      True</span><br><span class="line">5      True</span><br><span class="line">6      True</span><br><span class="line">7      True</span><br><span class="line">8      True</span><br><span class="line">9      True</span><br><span class="line">10     True</span><br><span class="line">11     True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">移除重复数据:</span><br><span class="line">        fruit  price</span><br><span class="line">0       apple   2.50</span><br><span class="line">1       pearl   3.00</span><br><span class="line">2  watermelon   2.75</span><br></pre></td></tr></table></figure>
<h3 id="5-4-Transform-Data"><a href="#5-4-Transform-Data" class="headerlink" title="5.4 Transform Data"></a>5.4 Transform Data</h3><p><code>DataFrame</code> 里的数据未必是原始数据, 例如采集时设定了一些协议, 1代表某某、2代表另一个事务或内容, 那么当开发者得到这些协议后的编码, 需要做一些数据上的变换, 以便真实的反映数据本身.</p>
<h4 id="5-4-1-Series-map"><a href="#5-4-1-Series-map" class="headerlink" title="5.4.1 Series.map()"></a>5.4.1 Series.map()</h4><p><code>map()</code> 是一个 Series 的函数，DataFrame结构中没有map(). <code>map()</code> 将一个自定义函数应用于 Series 结构中的每个元素(elements). 我们看个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;key1&#x27;</span> : [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;key2&#x27;</span> : [<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;one&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;data1&#x27;</span> : np.arange(<span class="number">5</span>),</span><br><span class="line">                   <span class="string">&#x27;data2&#x27;</span> : np.arange(<span class="number">5</span>,<span class="number">10</span>)&#125;)</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们现在用map来对列 data1 改成保留小数点后三位&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;data1&#x27;</span>] = df[<span class="string">&#x27;data1&#x27;</span>].<span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="string">&#x27;%.3f&#x27;</span>%x)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;用map把key1的a改成c，b改成d&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;key1&#x27;</span>] = df[<span class="string">&#x27;key1&#x27;</span>].<span class="built_in">map</span>(&#123;<span class="string">&#x27;a&#x27;</span>:<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;b&#x27;</span>:<span class="string">&#x27;d&#x27;</span>&#125;)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;修改后的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">  key1 key2  data1  data2</span><br><span class="line">0    a  one      0      5</span><br><span class="line">1    a  two      1      6</span><br><span class="line">2    b  one      2      7</span><br><span class="line">3    b  two      3      8</span><br><span class="line">4    a  one      4      9</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">我们现在用map来对列 data1 改成保留小数点后三位</span><br><span class="line">用map把key1的a改成c，b改成d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">修改后的数据是:</span><br><span class="line">  key1 key2  data1  data2</span><br><span class="line">0    c  one  0.000      5</span><br><span class="line">1    c  two  1.000      6</span><br><span class="line">2    d  one  2.000      7</span><br><span class="line">3    d  two  3.000      8</span><br><span class="line">4    c  one  4.000      9</span><br></pre></td></tr></table></figure>
<h4 id="5-4-2-DataFrame-replace"><a href="#5-4-2-DataFrame-replace" class="headerlink" title="5.4.2 DataFrame.replace()"></a>5.4.2 DataFrame.replace()</h4><p>之前我们将的 <code>fillna()</code> 函数可以将NaN数据填充为0,这里的replace函数可以将数据替换成其他数据. replace函数的使用方式有很多, 可以一对一的替换也可一对多的替换数据. 用法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.replace(self, to_replace=<span class="literal">None</span>, value=<span class="literal">None</span>, inplace=<span class="literal">False</span>, limit=<span class="literal">None</span>, regex=<span class="literal">False</span>, method=<span class="string">&#x27;pad&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># to_replace: 将要被替换的值, 可以是 str, regex, dict 以及 list. 若是 dict, 那么 value 参数应该设置为 None. </span></span><br><span class="line"><span class="comment"># value: 用于替换 to_replace 中匹配到的值</span></span><br><span class="line"><span class="comment"># inplace: 是否修改原 DataFrame, 默认为 False, 也就是返回一个新的 DataFrame</span></span><br><span class="line"><span class="comment"># method: 要使用这个 to_replace 必须是标量, 而且 value 设置为 None. method 有以下几个选项: &#x27;mad&#x27;, &#x27;bfill&#x27;, &#x27;ffill&#x27;, &#x27;None&#x27;</span></span><br><span class="line"><span class="comment"># limit: 向后或向前填充的数量</span></span><br></pre></td></tr></table></figure>
<p>我们看一个正则表达式的例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;bat&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;bait&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;bar&#x27;</span>, <span class="string">&#x27;xyz&#x27;</span>]&#125;)</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;替换后的数据是:&#x27;</span>)</span><br><span class="line">df1 = df.replace(to_replace=<span class="string">r&#x27;^ba.$&#x27;</span>,value=<span class="string">&#x27;new&#x27;</span>,regex=<span class="literal">True</span>)</span><br><span class="line">print(df1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下面这三种方式也是一样的效果</span></span><br><span class="line">df1 = df.replace(regex=<span class="string">r&#x27;^ba.$&#x27;</span>, value=<span class="string">&#x27;new&#x27;</span>)</span><br><span class="line">df1 = df.replace(regex=&#123;<span class="string">r&#x27;^ba.$&#x27;</span>: <span class="string">&#x27;new&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>: <span class="string">&#x27;xyz&#x27;</span>&#125;)</span><br><span class="line">df1 = df.replace(regex=[<span class="string">r&#x27;^ba.$&#x27;</span>, <span class="string">&#x27;foo&#x27;</span>], value=<span class="string">&#x27;new&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">      A    B</span><br><span class="line">0   bat  abc</span><br><span class="line">1   foo  bar</span><br><span class="line">2  bait  xyz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">替换后的数据是:</span><br><span class="line">      A    B</span><br><span class="line">0   new  abc</span><br><span class="line">1   foo  new</span><br><span class="line">2  bait  xyz</span><br></pre></td></tr></table></figure>
<h4 id="5-4-3-DataFrame-apply"><a href="#5-4-3-DataFrame-apply" class="headerlink" title="5.4.3 DataFrame.apply()"></a>5.4.3 DataFrame.apply()</h4><p><code>apply()</code> 将一个函数作用于DataFrame中的每个行或者列, 看个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;key1&#x27;</span> : [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;key2&#x27;</span> : [<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;one&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;data1&#x27;</span> : np.arange(<span class="number">5</span>),</span><br><span class="line">                   <span class="string">&#x27;data2&#x27;</span> : np.arange(<span class="number">5</span>,<span class="number">10</span>)&#125;)</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;使用 apply() 求每列的和&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;使用 apply() 对列 data1, data2 进行相加&#x27;</span>)</span><br><span class="line"></span><br><span class="line">df.loc[<span class="string">&#x27;total&#x27;</span>] = df[[<span class="string">&#x27;data1&#x27;</span>,<span class="string">&#x27;data2&#x27;</span>]].apply(<span class="keyword">lambda</span> x: x.<span class="built_in">sum</span>(), axis=<span class="number">0</span>)</span><br><span class="line">df[<span class="string">&#x27;total&#x27;</span>] = df[[<span class="string">&#x27;data1&#x27;</span>,<span class="string">&#x27;data2&#x27;</span>]].apply(<span class="keyword">lambda</span> x: x.<span class="built_in">sum</span>(), axis=<span class="number">1</span>)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;修改之后的数据:&#x27;</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">  key1 key2  data1  data2</span><br><span class="line">0    a  one      0      5</span><br><span class="line">1    a  two      1      6</span><br><span class="line">2    b  one      2      7</span><br><span class="line">3    b  two      3      8</span><br><span class="line">4    a  one      4      9</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用 apply() 求每列的和</span><br><span class="line">使用 apply() 对列 data1, data2 进行相加</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">修改之后的数据:</span><br><span class="line">      key1 key2  data1  data2  total</span><br><span class="line">0        a  one    0.0    5.0    5.0</span><br><span class="line">1        a  two    1.0    6.0    7.0</span><br><span class="line">2        b  one    2.0    7.0    9.0</span><br><span class="line">3        b  two    3.0    8.0   11.0</span><br><span class="line">4        a  one    4.0    9.0   13.0</span><br><span class="line">total  NaN  NaN   10.0   35.0   45.0</span><br></pre></td></tr></table></figure>
<h4 id="5-4-5-DataFrame-applymap"><a href="#5-4-5-DataFrame-applymap" class="headerlink" title="5.4.5 DataFrame.applymap()"></a>5.4.5 DataFrame.applymap()</h4><p>将函数作用于 DataFrame 中的所有元素(elements), 看个例子:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;key1&#x27;</span> : [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;a&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;key2&#x27;</span> : [<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;one&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;data1&#x27;</span> : np.arange(<span class="number">5</span>),</span><br><span class="line">                   <span class="string">&#x27;data2&#x27;</span> : np.arange(<span class="number">5</span>,<span class="number">10</span>)&#125;)</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addA</span>(<span class="params">x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;A&#x27;</span> + <span class="built_in">str</span>(x)</span><br><span class="line"></span><br><span class="line">df2 = df.applymap(addA)</span><br><span class="line">print(<span class="string">&#x27;修改后的数据是:&#x27;</span>)</span><br><span class="line">print(df2)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">  key1 key2  data1  data2</span><br><span class="line">0    a  one      0      5</span><br><span class="line">1    a  two      1      6</span><br><span class="line">2    b  one      2      7</span><br><span class="line">3    b  two      3      8</span><br><span class="line">4    a  one      4      9</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">修改后的数据是:</span><br><span class="line">  key1  key2 data1 data2</span><br><span class="line">0   Aa  Aone    A0    A5</span><br><span class="line">1   Aa  Atwo    A1    A6</span><br><span class="line">2   Ab  Aone    A2    A7</span><br><span class="line">3   Ab  Atwo    A3    A8</span><br><span class="line">4   Aa  Aone    A4    A9</span><br></pre></td></tr></table></figure>
<h3 id="5-5-Data-Concatenation"><a href="#5-5-Data-Concatenation" class="headerlink" title="5.5 Data Concatenation"></a>5.5 Data Concatenation</h3><p>这里主要有两个函数: </p>
<ul>
<li><code>DataFrame.concat()</code></li>
<li><code>DataFrame.merge()</code></li>
</ul>
<h4 id="5-5-1-pandas-concat"><a href="#5-5-1-pandas-concat" class="headerlink" title="5.5.1 pandas.concat()"></a>5.5.1 pandas.concat()</h4><p><code>concat()</code> 函数的用法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pandas.concat(objs, axis=<span class="number">0</span>, join=<span class="string">&#x27;outer&#x27;</span>, join_axes=<span class="literal">None</span>, ignore_index=<span class="literal">False</span>, keys=<span class="literal">None</span>, names=<span class="literal">None</span>, verify_integrity=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># objs: series, dataframe或者是panel构成的序列list</span></span><br><span class="line"><span class="comment"># axis: 需要合并链接的轴，0是行, 1是列</span></span><br><span class="line"><span class="comment"># join: 连接方式 inner(交集) 或者 outer(并集)</span></span><br><span class="line"><span class="comment"># keys: 用于指明数据分别来自哪个 DataFrame</span></span><br><span class="line"><span class="comment"># join_axes: 以哪张表的行 index 为基准</span></span><br><span class="line"><span class="comment"># ignore_index: 如果两个表的index都没有实际含义, 使用ignore_index参数. 合并的两个表就根据列字段对齐, 然后合并, 最后再重新整理一个新的index</span></span><br></pre></td></tr></table></figure>
<p><strong>我们竖直拼接的例子</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>:[<span class="string">&#x27;A0&#x27;</span>,<span class="string">&#x27;A1&#x27;</span>,<span class="string">&#x27;A2&#x27;</span>,<span class="string">&#x27;A3&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;B&#x27;</span>:[<span class="string">&#x27;B0&#x27;</span>,<span class="string">&#x27;B1&#x27;</span>,<span class="string">&#x27;B2&#x27;</span>,<span class="string">&#x27;B3&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;C&#x27;</span>:[<span class="string">&#x27;C0&#x27;</span>,<span class="string">&#x27;C1&#x27;</span>,<span class="string">&#x27;C2&#x27;</span>,<span class="string">&#x27;C3&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;D&#x27;</span>:[<span class="string">&#x27;D0&#x27;</span>,<span class="string">&#x27;D1&#x27;</span>,<span class="string">&#x27;D2&#x27;</span>,<span class="string">&#x27;D3&#x27;</span>]&#125;, index=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>:[<span class="string">&#x27;A4&#x27;</span>,<span class="string">&#x27;A5&#x27;</span>,<span class="string">&#x27;A6&#x27;</span>,<span class="string">&#x27;A7&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;B&#x27;</span>:[<span class="string">&#x27;B4&#x27;</span>,<span class="string">&#x27;B5&#x27;</span>,<span class="string">&#x27;B6&#x27;</span>,<span class="string">&#x27;B7&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;C&#x27;</span>:[<span class="string">&#x27;C4&#x27;</span>,<span class="string">&#x27;C5&#x27;</span>,<span class="string">&#x27;C6&#x27;</span>,<span class="string">&#x27;C7&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;D&#x27;</span>:[<span class="string">&#x27;D4&#x27;</span>,<span class="string">&#x27;D5&#x27;</span>,<span class="string">&#x27;D6&#x27;</span>,<span class="string">&#x27;D7&#x27;</span>]&#125;, index=[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]) </span><br><span class="line"></span><br><span class="line">df3 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>:[<span class="string">&#x27;A8&#x27;</span>,<span class="string">&#x27;A9&#x27;</span>,<span class="string">&#x27;A10&#x27;</span>,<span class="string">&#x27;A11&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;B&#x27;</span>:[<span class="string">&#x27;B8&#x27;</span>,<span class="string">&#x27;B9&#x27;</span>,<span class="string">&#x27;B10&#x27;</span>,<span class="string">&#x27;B11&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;C&#x27;</span>:[<span class="string">&#x27;C8&#x27;</span>,<span class="string">&#x27;C9&#x27;</span>,<span class="string">&#x27;C10&#x27;</span>,<span class="string">&#x27;C11&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;D&#x27;</span>:[<span class="string">&#x27;D8&#x27;</span>,<span class="string">&#x27;D9&#x27;</span>,<span class="string">&#x27;D10&#x27;</span>,<span class="string">&#x27;D11&#x27;</span>]&#125;, index=[<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>]) </span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们的三个 DataFrame 分别是:&#x27;</span>)</span><br><span class="line">print(df1)</span><br><span class="line">print()</span><br><span class="line">print(df2)</span><br><span class="line">print()</span><br><span class="line">print(df3)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;我们竖直拼接三个 DataFrame, 并指明其来源:&#x27;</span>)</span><br><span class="line">print(pd.concat([df1,df2,df3], axis=<span class="number">0</span>, keys=[<span class="string">&#x27;df1&#x27;</span>,<span class="string">&#x27;df2&#x27;</span>,<span class="string">&#x27;df3&#x27;</span>]))</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">我们的三个 DataFrame 分别是:</span><br><span class="line">    A   B   C   D</span><br><span class="line">0  A0  B0  C0  D0</span><br><span class="line">1  A1  B1  C1  D1</span><br><span class="line">2  A2  B2  C2  D2</span><br><span class="line">3  A3  B3  C3  D3</span><br><span class="line"></span><br><span class="line">    A   B   C   D</span><br><span class="line">4  A4  B4  C4  D4</span><br><span class="line">5  A5  B5  C5  D5</span><br><span class="line">6  A6  B6  C6  D6</span><br><span class="line">7  A7  B7  C7  D7</span><br><span class="line"></span><br><span class="line">      A    B    C    D</span><br><span class="line">8    A8   B8   C8   D8</span><br><span class="line">9    A9   B9   C9   D9</span><br><span class="line">10  A10  B10  C10  D10</span><br><span class="line">11  A11  B11  C11  D11</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">我们竖直拼接三个 DataFrame, 并指明其来源:</span><br><span class="line">          A    B    C    D</span><br><span class="line">df1 0    A0   B0   C0   D0</span><br><span class="line">    1    A1   B1   C1   D1</span><br><span class="line">    2    A2   B2   C2   D2</span><br><span class="line">    3    A3   B3   C3   D3</span><br><span class="line">df2 4    A4   B4   C4   D4</span><br><span class="line">    5    A5   B5   C5   D5</span><br><span class="line">    6    A6   B6   C6   D6</span><br><span class="line">    7    A7   B7   C7   D7</span><br><span class="line">df3 8    A8   B8   C8   D8</span><br><span class="line">    9    A9   B9   C9   D9</span><br><span class="line">    10  A10  B10  C10  D10</span><br><span class="line">    11  A11  B11  C11  D11</span><br></pre></td></tr></table></figure>
<p><strong>我们看一个水平拼接的例子</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df1 = pd.DataFrame(&#123;<span class="string">&#x27;A&#x27;</span>:[<span class="string">&#x27;A0&#x27;</span>,<span class="string">&#x27;A1&#x27;</span>,<span class="string">&#x27;A2&#x27;</span>,<span class="string">&#x27;A3&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;B&#x27;</span>:[<span class="string">&#x27;B0&#x27;</span>,<span class="string">&#x27;B1&#x27;</span>,<span class="string">&#x27;B2&#x27;</span>,<span class="string">&#x27;B3&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;C&#x27;</span>:[<span class="string">&#x27;C0&#x27;</span>,<span class="string">&#x27;C1&#x27;</span>,<span class="string">&#x27;C2&#x27;</span>,<span class="string">&#x27;C3&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;D&#x27;</span>:[<span class="string">&#x27;D0&#x27;</span>,<span class="string">&#x27;D1&#x27;</span>,<span class="string">&#x27;D2&#x27;</span>,<span class="string">&#x27;D3&#x27;</span>]&#125;, index=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">&#x27;A1&#x27;</span>:[<span class="string">&#x27;A4&#x27;</span>,<span class="string">&#x27;A5&#x27;</span>,<span class="string">&#x27;A6&#x27;</span>,<span class="string">&#x27;A7&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;B2&#x27;</span>:[<span class="string">&#x27;B4&#x27;</span>,<span class="string">&#x27;B5&#x27;</span>,<span class="string">&#x27;B6&#x27;</span>,<span class="string">&#x27;B7&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;C2&#x27;</span>:[<span class="string">&#x27;C4&#x27;</span>,<span class="string">&#x27;C5&#x27;</span>,<span class="string">&#x27;C6&#x27;</span>,<span class="string">&#x27;C7&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;D2&#x27;</span>:[<span class="string">&#x27;D4&#x27;</span>,<span class="string">&#x27;D5&#x27;</span>,<span class="string">&#x27;D6&#x27;</span>,<span class="string">&#x27;D7&#x27;</span>]&#125;, index=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]) </span><br><span class="line"></span><br><span class="line">df3 = pd.DataFrame(&#123;<span class="string">&#x27;A3&#x27;</span>:[<span class="string">&#x27;A8&#x27;</span>,<span class="string">&#x27;A9&#x27;</span>,<span class="string">&#x27;A10&#x27;</span>,<span class="string">&#x27;A11&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;B3&#x27;</span>:[<span class="string">&#x27;B8&#x27;</span>,<span class="string">&#x27;B9&#x27;</span>,<span class="string">&#x27;B10&#x27;</span>,<span class="string">&#x27;B11&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;C3&#x27;</span>:[<span class="string">&#x27;C8&#x27;</span>,<span class="string">&#x27;C9&#x27;</span>,<span class="string">&#x27;C10&#x27;</span>,<span class="string">&#x27;C11&#x27;</span>],</span><br><span class="line">                   <span class="string">&#x27;D3&#x27;</span>:[<span class="string">&#x27;D8&#x27;</span>,<span class="string">&#x27;D9&#x27;</span>,<span class="string">&#x27;D10&#x27;</span>,<span class="string">&#x27;D11&#x27;</span>]&#125;, index=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]) </span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们的三个 DataFrame 分别是:&#x27;</span>)</span><br><span class="line">print(df1)</span><br><span class="line">print()</span><br><span class="line">print(df2)</span><br><span class="line">print()</span><br><span class="line">print(df3)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;我们水平拼接三个 DataFrame, 并指明其来源:&#x27;</span>)</span><br><span class="line">print(pd.concat([df1,df2,df3], axis=<span class="number">1</span>, keys=[<span class="string">&#x27;df1&#x27;</span>,<span class="string">&#x27;df2&#x27;</span>,<span class="string">&#x27;df3&#x27;</span>]))</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">我们的三个 DataFrame 分别是:</span><br><span class="line">    A   B   C   D</span><br><span class="line">0  A0  B0  C0  D0</span><br><span class="line">1  A1  B1  C1  D1</span><br><span class="line">2  A2  B2  C2  D2</span><br><span class="line">3  A3  B3  C3  D3</span><br><span class="line"></span><br><span class="line">   A1  B2  C2  D2</span><br><span class="line">0  A4  B4  C4  D4</span><br><span class="line">1  A5  B5  C5  D5</span><br><span class="line">2  A6  B6  C6  D6</span><br><span class="line">3  A7  B7  C7  D7</span><br><span class="line"></span><br><span class="line">    A3   B3   C3   D3</span><br><span class="line">0   A8   B8   C8   D8</span><br><span class="line">1   A9   B9   C9   D9</span><br><span class="line">2  A10  B10  C10  D10</span><br><span class="line">3  A11  B11  C11  D11</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">我们水平拼接三个 DataFrame, 并指明其来源:</span><br><span class="line">  df1             df2              df3</span><br><span class="line">    A   B   C   D  A1  B2  C2  D2   A3   B3   C3   D3</span><br><span class="line">0  A0  B0  C0  D0  A4  B4  C4  D4   A8   B8   C8   D8</span><br><span class="line">1  A1  B1  C1  D1  A5  B5  C5  D5   A9   B9   C9   D9</span><br><span class="line">2  A2  B2  C2  D2  A6  B6  C6  D6  A10  B10  C10  D10</span><br><span class="line">3  A3  B3  C3  D3  A7  B7  C7  D7  A11  B11  C11  D11</span><br></pre></td></tr></table></figure>
<h4 id="5-5-2-pandas-merge"><a href="#5-5-2-pandas-merge" class="headerlink" title="5.5.2 pandas.merge()"></a>5.5.2 pandas.merge()</h4><p>concat函数可以实现内外连接, 而pandas的merge函数可以真正实现数据库的内外连接, 且外连接还可以有左右连接的特性. 用法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">pandas.merge(left, right, how=<span class="string">&#x27;inner&#x27;</span>, on=<span class="literal">None</span>, left_on=<span class="literal">None</span>, right_on=<span class="literal">None</span>, left_index=<span class="literal">False</span>, right_index=<span class="literal">False</span>, sort=<span class="literal">True</span>, suffixes=(<span class="string">&#x27;_x&#x27;</span>,<span class="string">&#x27;_y&#x27;</span>), copy=<span class="literal">True</span>, indicator=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># left: 拼接的左侧DataFrame对象</span></span><br><span class="line"><span class="comment"># right: 拼接的右侧DataFrame对象</span></span><br><span class="line"><span class="comment"># on: 要加入的列或索引级别名称. 必须在左侧和右侧DataFrame对象中找到. 如果未传递且left_index和right_index为False, 则DataFrame中的列的交集将被推断为连接键.</span></span><br><span class="line"><span class="comment"># left_on: 左侧DataFrame中的列或索引级别用作键.</span></span><br><span class="line"><span class="comment"># right_on: 右侧DataFrame中的列或索引级别用作键.</span></span><br><span class="line"><span class="comment"># left_index: 如果为True，则使用左侧DataFrame中的索引（行标签）作为其连接键.</span></span><br><span class="line"><span class="comment"># right_index: 与left_index功能相似.</span></span><br><span class="line"><span class="comment"># how: One of &#x27;left&#x27;, &#x27;right&#x27;, &#x27;outer&#x27;, &#x27;inner&#x27;. 默认inner. inner是取交集，outer取并集.</span></span><br><span class="line"><span class="comment"># copy: 始终从传递的DataFrame对象复制数据 (默认为True), 即使不需要重建索引也是如此.</span></span><br></pre></td></tr></table></figure>
<p><strong>我们看一个简单的例子</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">left = pd.DataFrame(&#123;<span class="string">&#x27;key&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K2&#x27;</span>, <span class="string">&#x27;K3&#x27;</span>],</span><br><span class="line">                       <span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>, <span class="string">&#x27;A2&#x27;</span>, <span class="string">&#x27;A3&#x27;</span>],</span><br><span class="line">                       <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B0&#x27;</span>, <span class="string">&#x27;B1&#x27;</span>, <span class="string">&#x27;B2&#x27;</span>, <span class="string">&#x27;B3&#x27;</span>]&#125;)</span><br><span class="line">right = pd.DataFrame(&#123;<span class="string">&#x27;key&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K2&#x27;</span>, <span class="string">&#x27;K3&#x27;</span>],</span><br><span class="line">                        <span class="string">&#x27;C&#x27;</span>: [<span class="string">&#x27;C0&#x27;</span>, <span class="string">&#x27;C1&#x27;</span>, <span class="string">&#x27;C2&#x27;</span>, <span class="string">&#x27;C3&#x27;</span>],</span><br><span class="line">                        <span class="string">&#x27;D&#x27;</span>: [<span class="string">&#x27;D0&#x27;</span>, <span class="string">&#x27;D1&#x27;</span>, <span class="string">&#x27;D2&#x27;</span>, <span class="string">&#x27;D3&#x27;</span>]&#125;)</span><br><span class="line">result = pd.merge(left, right, on=<span class="string">&#x27;key&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;左表是:&#x27;</span>)</span><br><span class="line">print(left)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;右表示:&#x27;</span>)</span><br><span class="line">print(right)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;拼接结果是:&#x27;</span>)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">左表是:</span><br><span class="line">  key   A   B</span><br><span class="line">0  K0  A0  B0</span><br><span class="line">1  K1  A1  B1</span><br><span class="line">2  K2  A2  B2</span><br><span class="line">3  K3  A3  B3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">右表是:</span><br><span class="line">  key   C   D</span><br><span class="line">0  K0  C0  D0</span><br><span class="line">1  K1  C1  D1</span><br><span class="line">2  K2  C2  D2</span><br><span class="line">3  K3  C3  D3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">拼接结果是:</span><br><span class="line">  key   A   B   C   D</span><br><span class="line">0  K0  A0  B0  C0  D0</span><br><span class="line">1  K1  A1  B1  C1  D1</span><br><span class="line">2  K2  A2  B2  C2  D2</span><br><span class="line">3  K3  A3  B3  C3  D3</span><br></pre></td></tr></table></figure>
<p><strong>传入的 on 也可以是列表</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">left = pd.DataFrame(&#123;<span class="string">&#x27;key1&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K2&#x27;</span>],</span><br><span class="line">                      <span class="string">&#x27;key2&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>],</span><br><span class="line">                         <span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>, <span class="string">&#x27;A2&#x27;</span>, <span class="string">&#x27;A3&#x27;</span>],</span><br><span class="line">                         <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B0&#x27;</span>, <span class="string">&#x27;B1&#x27;</span>, <span class="string">&#x27;B2&#x27;</span>, <span class="string">&#x27;B3&#x27;</span>]&#125;)</span><br><span class="line"></span><br><span class="line">right = pd.DataFrame(&#123;<span class="string">&#x27;key1&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K2&#x27;</span>],</span><br><span class="line">                      <span class="string">&#x27;key2&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>],</span><br><span class="line">                         <span class="string">&#x27;C&#x27;</span>: [<span class="string">&#x27;C0&#x27;</span>, <span class="string">&#x27;C1&#x27;</span>, <span class="string">&#x27;C2&#x27;</span>, <span class="string">&#x27;C3&#x27;</span>],</span><br><span class="line">                         <span class="string">&#x27;D&#x27;</span>: [<span class="string">&#x27;D0&#x27;</span>, <span class="string">&#x27;D1&#x27;</span>, <span class="string">&#x27;D2&#x27;</span>, <span class="string">&#x27;D3&#x27;</span>]&#125;)</span><br><span class="line">result = pd.merge(left, right, on=[<span class="string">&#x27;key1&#x27;</span>,<span class="string">&#x27;key2&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;左表是:&#x27;</span>)</span><br><span class="line">print(left)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;右表是:&#x27;</span>)</span><br><span class="line">print(right)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;拼接结果是:&#x27;</span>)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">左表是:</span><br><span class="line">  key1 key2   A   B</span><br><span class="line">0   K0   K0  A0  B0</span><br><span class="line">1   K0   K1  A1  B1</span><br><span class="line">2   K1   K0  A2  B2</span><br><span class="line">3   K2   K1  A3  B3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">右表是:</span><br><span class="line">  key1 key2   C   D</span><br><span class="line">0   K0   K0  C0  D0</span><br><span class="line">1   K1   K0  C1  D1</span><br><span class="line">2   K1   K0  C2  D2</span><br><span class="line">3   K2   K0  C3  D3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">拼接结果是:</span><br><span class="line">  key1 key2   A   B   C   D</span><br><span class="line">0   K0   K0  A0  B0  C0  D0</span><br><span class="line">1   K1   K0  A2  B2  C1  D1</span><br><span class="line">2   K1   K0  A2  B2  C2  D2</span><br></pre></td></tr></table></figure>
<p><strong>左外连接</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">left = pd.DataFrame(&#123;<span class="string">&#x27;key1&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K2&#x27;</span>],</span><br><span class="line">                      <span class="string">&#x27;key2&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>],</span><br><span class="line">                         <span class="string">&#x27;A&#x27;</span>: [<span class="string">&#x27;A0&#x27;</span>, <span class="string">&#x27;A1&#x27;</span>, <span class="string">&#x27;A2&#x27;</span>, <span class="string">&#x27;A3&#x27;</span>],</span><br><span class="line">                         <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;B0&#x27;</span>, <span class="string">&#x27;B1&#x27;</span>, <span class="string">&#x27;B2&#x27;</span>, <span class="string">&#x27;B3&#x27;</span>]&#125;)</span><br><span class="line"></span><br><span class="line">right = pd.DataFrame(&#123;<span class="string">&#x27;key1&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K1&#x27;</span>, <span class="string">&#x27;K2&#x27;</span>],</span><br><span class="line">                      <span class="string">&#x27;key2&#x27;</span>: [<span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>, <span class="string">&#x27;K0&#x27;</span>],</span><br><span class="line">                         <span class="string">&#x27;C&#x27;</span>: [<span class="string">&#x27;C0&#x27;</span>, <span class="string">&#x27;C1&#x27;</span>, <span class="string">&#x27;C2&#x27;</span>, <span class="string">&#x27;C3&#x27;</span>],</span><br><span class="line">                         <span class="string">&#x27;D&#x27;</span>: [<span class="string">&#x27;D0&#x27;</span>, <span class="string">&#x27;D1&#x27;</span>, <span class="string">&#x27;D2&#x27;</span>, <span class="string">&#x27;D3&#x27;</span>]&#125;)</span><br><span class="line">result = pd.merge(left, right, how=<span class="string">&#x27;left&#x27;</span>, on=[<span class="string">&#x27;key1&#x27;</span>,<span class="string">&#x27;key2&#x27;</span>])</span><br><span class="line">print(<span class="string">&#x27;左表是:&#x27;</span>)</span><br><span class="line">print(left)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;右表是:&#x27;</span>)</span><br><span class="line">print(right)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;拼接结果是:&#x27;</span>)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">左表是:</span><br><span class="line">  key1 key2   A   B</span><br><span class="line">0   K0   K0  A0  B0</span><br><span class="line">1   K0   K1  A1  B1</span><br><span class="line">2   K1   K0  A2  B2</span><br><span class="line">3   K2   K1  A3  B3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">右表是:</span><br><span class="line">  key1 key2   C   D</span><br><span class="line">0   K0   K0  C0  D0</span><br><span class="line">1   K1   K0  C1  D1</span><br><span class="line">2   K1   K0  C2  D2</span><br><span class="line">3   K2   K0  C3  D3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">拼接结果是:</span><br><span class="line">  key1 key2   A   B    C    D</span><br><span class="line">0   K0   K0  A0  B0   C0   D0</span><br><span class="line">1   K0   K1  A1  B1  NaN  NaN</span><br><span class="line">2   K1   K0  A2  B2   C1   D1</span><br><span class="line">3   K1   K0  A2  B2   C2   D2</span><br><span class="line">4   K2   K1  A3  B3  NaN  NaN</span><br></pre></td></tr></table></figure>
<h3 id="5-6-Reforming-Data"><a href="#5-6-Reforming-Data" class="headerlink" title="5.6 Reforming Data"></a>5.6 Reforming Data</h3><h4 id="5-6-1-DataFrame-pivot"><a href="#5-6-1-DataFrame-pivot" class="headerlink" title="5.6.1 DataFrame.pivot()"></a>5.6.1 DataFrame.pivot()</h4><p>返回按给定索引/列以及制定的<strong>列值</strong>的重新构造的 <code>pivot table</code>. 如果作为 <code>columns</code> 的列具有重复值, 那么在使用 <code>pivot</code> 函数的时候就会报错, 此时我们需要使用<code>DataFrame.pivot_table</code>.</p>
<p><code>DataFrame.pivot()</code> 的用法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.pivot(self, index=<span class="literal">None</span>, columns=<span class="literal">None</span>, values=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># index: 用于制作新 frame 索引的列. 如果为None, 则使用现有索引.</span></span><br><span class="line"><span class="comment"># columns: 用于制作新 frame columns的列.</span></span><br><span class="line"><span class="comment"># values: 用于填充新frame值的列. 如果未指定, 将使用所有剩余的列, 并且结果将具有按层次结构索引的列.</span></span><br></pre></td></tr></table></figure>
<p><strong>看个例子</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;foo&#x27;</span>: [<span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;one&#x27;</span>, <span class="string">&#x27;two&#x27;</span>, <span class="string">&#x27;two&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;two&#x27;</span>],</span><br><span class="line">                     <span class="string">&#x27;bar&#x27;</span>: [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>],</span><br><span class="line">                     <span class="string">&#x27;baz&#x27;</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">                     <span class="string">&#x27;zoo&#x27;</span>: [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;t&#x27;</span>]&#125;)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;使用 pivot 函数:&#x27;</span>)</span><br><span class="line">print(df.pivot(index=<span class="string">&#x27;foo&#x27;</span>, columns=<span class="string">&#x27;bar&#x27;</span>))</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">   foo bar  baz zoo</span><br><span class="line">0  one   A    1   x</span><br><span class="line">1  one   B    2   y</span><br><span class="line">2  one   C    3   z</span><br><span class="line">3  two   A    4   q</span><br><span class="line">4  two   B    5   w</span><br><span class="line">5  two   C    6   t</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用 pivot 函数:</span><br><span class="line">    baz       zoo</span><br><span class="line">bar   A  B  C   A  B  C</span><br><span class="line">foo</span><br><span class="line">one   1  2  3   x  y  z</span><br><span class="line">two   4  5  6   q  w  t</span><br></pre></td></tr></table></figure>
<h4 id="5-6-2-DataFrame-pivot-table"><a href="#5-6-2-DataFrame-pivot-table" class="headerlink" title="5.6.2 DataFrame.pivot_table()"></a>5.6.2 DataFrame.pivot_table()</h4><p>与 <code>pivot</code> 相比，该方法可以汇总多个重复条目的数据. 我们可以用均值、中位数或者其他汇总函数来计算重复条目的数值. <code>pivot_table</code> 方法需要传递一个新的参数 <code>aggfunc</code>, 该参数用于指明转换时所需的汇总函数. 我们看个图解:</p>
<p><img src="https://i.loli.net/2020/08/21/bKMwTRQqtrDHfEs.png" alt="image-20200820012507360"></p>
<p><strong>该函数的用法如下</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.pivot_table(self, index=<span class="literal">None</span>, columns=<span class="literal">None</span>, values=<span class="literal">None</span>, aggfunc=<span class="string">&#x27;mean&#x27;</span>, fill_value=<span class="literal">None</span>, margins=<span class="literal">False</span>, dropna=<span class="literal">True</span>, margins_name=<span class="string">&#x27;All&#x27;</span>, observed=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># index: 用于制作新 pivot table 索引的列. 如果为None, 则使用现有索引.</span></span><br><span class="line"><span class="comment"># columns: 用于制作新 pivot table columns的列.</span></span><br><span class="line"><span class="comment"># values: 要汇总的列</span></span><br><span class="line"><span class="comment"># aggfunc: 如何处理重复数据</span></span><br><span class="line"><span class="comment"># fill_value: 替换缺失值</span></span><br><span class="line"><span class="comment"># margins: 添加行/列小计和总计</span></span><br></pre></td></tr></table></figure>
<p><strong>我们来看一个 NBA 的例子, 先读取数据</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;James_Harden.csv&#x27;</span>,encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/20/Xj364nqTMADB1dl.png" alt="image-20200820190107889" style="zoom:50%;" /></p>
<p><strong>然后我们看一下哈登对阵每个队伍的情况</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.pivot_table(index=<span class="string">u&#x27;对手&#x27;</span>).head()</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/20/FYWljmPbdVKo691.png" alt="image-20200820190455915" style="zoom:50%;" /></p>
<p><strong>让我们继续深入, 不同对手以及主客场情况下的得分概况</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.pivot_table(index=[<span class="string">u&#x27;对手&#x27;</span>,<span class="string">u&#x27;主客场&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/20/FV64UcYhI2MtfvQ.png" alt="image-20200820190654432" style="zoom:50%;" /></p>
<blockquote>
<p>看完上面几个操作, Index就是层次字段, 要通过透视表获取什么信息就按照相应的顺序设置字段，所以在进行pivot之前你也需要足够了解你的数据.</p>
</blockquote>
<p><strong>当我们未设置 <code>aggfunc</code> 时, 它默认 <code>aggfunc=&#39;mean&#39;</code> 计算均值. 我们还想要获得james harden在主客场和不同胜负情况下的总得分、总篮板、总助攻概况</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.pivot_table(index=[<span class="string">u&#x27;主客场&#x27;</span>,<span class="string">u&#x27;胜负&#x27;</span>],values=[<span class="string">u&#x27;得分&#x27;</span>,<span class="string">u&#x27;助攻&#x27;</span>,<span class="string">u&#x27;篮板&#x27;</span>],aggfunc=[np.<span class="built_in">sum</span>,np.mean])</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/20/Iy7rDxTM2ERGjBl.png" alt="image-20200820191134830" style="zoom:50%;" /></p>
<blockquote>
<p>  Columns类似Index可以设置列层次字段, 它不是一个必要参数, 作为一种分割数据的可选方式.</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.pivot_table(index=[<span class="string">u&#x27;主客场&#x27;</span>],columns=[<span class="string">u&#x27;对手&#x27;</span>],values=[<span class="string">u&#x27;得分&#x27;</span>],aggfunc=[np.<span class="built_in">sum</span>],fill_value=<span class="number">0</span>,margins=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/20/9I8QvYmnkU2bVAz.png" alt="image-20200820191513716" style="zoom:50%;" /></p>
<blockquote>
<p>  最后看一个综合的例子</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.pivot_table(index=[<span class="string">u&#x27;对手&#x27;</span>,<span class="string">u&#x27;胜负&#x27;</span>],columns=[<span class="string">u&#x27;主客场&#x27;</span>],values=[<span class="string">u&#x27;得分&#x27;</span>,<span class="string">u&#x27;助攻&#x27;</span>,<span class="string">u&#x27;篮板&#x27;</span>],aggfunc=[np.mean],fill_value=<span class="number">0</span>).head()</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/20/4tmsjNbiXU8Twgx.png" alt="image-20200820191913922" style="zoom:50%;" /></p>
<h3 id="5-7-Aggregating-Data"><a href="#5-7-Aggregating-Data" class="headerlink" title="5.7 Aggregating Data"></a>5.7 Aggregating Data</h3><h4 id="5-7-1-DataFrame-groupby"><a href="#5-7-1-DataFrame-groupby" class="headerlink" title="5.7.1 DataFrame.groupby()"></a>5.7.1 DataFrame.groupby()</h4><p>在SQL语言里有group by功能，在Pandas里有groupby函数与之功能相对应. DataFrame数据对象经groupby()之后返回的结果是一个 <code>DataFrameGroupBy</code> 对象, 而不是一个 <code>DataFrame</code> 或者 <code>Series</code> 对象, 所以, 它们中的一些方法或者函数是无法直接调用的, 需要按照 <code>GroupBy</code> 对象中具有的函数和方法进行调用.</p>
<ul>
<li><code>ngroups</code> 反应的是分组的个数</li>
<li><code>groups</code> 类似 dict 结构</li>
<li><code>size()</code> 则是可以返回所有分组的数据个数.</li>
<li><code>count()</code> 可以统计分组后各列数据项个数</li>
<li><code>get_group()</code> 可以返回指定组的数据信息</li>
<li><code>discribe()</code> 可以返回分组后的数据的统计数据</li>
</ul>
<p><strong>我们创建一个 DataFrame</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">name = [<span class="string">&#x27;Alen&#x27;</span>,<span class="string">&#x27;Bob&#x27;</span>,<span class="string">&#x27;Cidy&#x27;</span>,<span class="string">&#x27;Daniel&#x27;</span>,<span class="string">&#x27;Ellen&#x27;</span>,<span class="string">&#x27;Frankie&#x27;</span>,<span class="string">&#x27;Gate&#x27;</span>,<span class="string">&#x27;Hebe&#x27;</span>]</span><br><span class="line">gender = [<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Female&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Female&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Female&#x27;</span>]</span><br><span class="line">age = [<span class="number">18</span>,<span class="number">19</span>,<span class="number">18</span>,<span class="number">20</span>,<span class="number">17</span>,<span class="number">21</span>,<span class="number">20</span>,<span class="number">22</span>]</span><br><span class="line">score = [<span class="number">80</span>,<span class="number">90</span>,<span class="number">93</span>,<span class="number">87</span>,<span class="number">96</span>,<span class="number">100</span>,<span class="number">88</span>,<span class="number">98</span>]</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(data=&#123;<span class="string">&#x27;Name&#x27;</span>:name,<span class="string">&#x27;Gender&#x27;</span>:gender,<span class="string">&#x27;Age&#x27;</span>:age,<span class="string">&#x27;Score&#x27;</span>:score&#125;)</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">      Name  Gender  Age  Score</span><br><span class="line">0     Alen    Male   18     80</span><br><span class="line">1      Bob    Male   19     90</span><br><span class="line">2     Cidy  Female   18     93</span><br><span class="line">3   Daniel    Male   20     87</span><br><span class="line">4    Ellen  Female   17     96</span><br><span class="line">5  Frankie    Male   21    100</span><br><span class="line">6     Gate    Male   20     88</span><br><span class="line">7     Hebe  Female   22     98</span><br></pre></td></tr></table></figure>
<p><strong>我们使用 <code>groupby()</code> 函数</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">grouped = df.groupby(<span class="string">&#x27;Gender&#x27;</span>)</span><br><span class="line">print(<span class="built_in">type</span>(grouped))</span><br><span class="line">print(grouped)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;class &#39;pandas.core.groupby.generic.DataFrameGroupBy&#39;&gt;</span><br><span class="line">&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7fb650d31490&gt;</span><br></pre></td></tr></table></figure>
<p><strong>分组时, 不仅仅可以指定一个列名, 也可以指定多个列名</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">grouped = df.groupby(<span class="string">&#x27;Gender&#x27;</span>)</span><br><span class="line">grouped_muti = df.groupby([<span class="string">&#x27;Gender&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>])</span><br><span class="line"></span><br><span class="line">print(grouped.size())</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">print(grouped_muti.size())</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Gender</span><br><span class="line">Female    3</span><br><span class="line">Male      5</span><br><span class="line">dtype: int64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Gender  Age</span><br><span class="line">Female  17     1</span><br><span class="line">        18     1</span><br><span class="line">        22     1</span><br><span class="line">Male    18     1</span><br><span class="line">        19     1</span><br><span class="line">        20     2</span><br><span class="line">        21     1</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure>
<p><strong>指定多个列名个单个列名后的区别在于, 分组的索引 (index) 将一个是单个主键, 另一个则是一个元组的形式</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = grouped.get_group(<span class="string">&#x27;Female&#x27;</span>)</span><br><span class="line">b = grouped_muti.get_group((<span class="string">&#x27;Female&#x27;</span>,<span class="number">17</span>))</span><br><span class="line"></span><br><span class="line">print(a)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">	Name  Age  Score</span><br><span class="line">2   Cidy   18     93</span><br><span class="line">4  Ellen   17     96</span><br><span class="line">7   Hebe   22     98</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Name  Gender  Age  Score</span><br><span class="line">4  Ellen  Female   17     96</span><br></pre></td></tr></table></figure>
<blockquote>
<p>  注: 通过调用<code>get_group()</code>函数可以返回一个按照分组得到的<code>DataFrame</code>对象, 所以接下来的使用就可以按照·DataFrame·对象来使用. 如果想让这个<code>DataFrame</code>对象的索引重新定义可以通过:</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(grouped.get_group(<span class="string">&#x27;Female&#x27;</span>).reset_index())</span><br></pre></td></tr></table></figure>
<p>  输出结果是:</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">   index   Name  Age  Score</span><br><span class="line">0      2   Cidy   18     93</span><br><span class="line">1      4  Ellen   17     96</span><br><span class="line">2      7   Hebe   22     98</span><br></pre></td></tr></table></figure>
<h4 id="5-7-2-DataFrame-agg"><a href="#5-7-2-DataFrame-agg" class="headerlink" title="5.7.2 DataFrame.agg()"></a>5.7.2 DataFrame.agg()</h4></blockquote>
<p>在对数据进行分组之后, 可以对分组后的数据进行聚合处理统计. 用法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.agg(func, axis=<span class="number">0</span>, *args, **kwargs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># func: 用于聚合数据的函数</span></span><br><span class="line"><span class="comment">#		- 字符串函数名称</span></span><br><span class="line"><span class="comment">#		- 函数</span></span><br><span class="line"><span class="comment">#  		- 函数列表</span></span><br><span class="line"><span class="comment"># 	 	- 列名称:函数或函数列表的字典</span></span><br><span class="line"><span class="comment"># axis: 0--&gt;竖直, 1--&gt;水平</span></span><br></pre></td></tr></table></figure>
<p><strong>看个例子, 求 age 和 score 的 mean 和 sum</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">name = [<span class="string">&#x27;Alen&#x27;</span>,<span class="string">&#x27;Bob&#x27;</span>,<span class="string">&#x27;Cidy&#x27;</span>,<span class="string">&#x27;Daniel&#x27;</span>,<span class="string">&#x27;Ellen&#x27;</span>,<span class="string">&#x27;Frankie&#x27;</span>,<span class="string">&#x27;Gate&#x27;</span>,<span class="string">&#x27;Hebe&#x27;</span>]</span><br><span class="line">gender = [<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Female&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Female&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Male&#x27;</span>,<span class="string">&#x27;Female&#x27;</span>]</span><br><span class="line">age = [<span class="number">18</span>,<span class="number">19</span>,<span class="number">18</span>,<span class="number">20</span>,<span class="number">17</span>,<span class="number">21</span>,<span class="number">20</span>,<span class="number">22</span>]</span><br><span class="line">score = [<span class="number">80</span>,<span class="number">90</span>,<span class="number">93</span>,<span class="number">87</span>,<span class="number">96</span>,<span class="number">100</span>,<span class="number">88</span>,<span class="number">98</span>]</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(data=&#123;<span class="string">&#x27;Name&#x27;</span>:name,<span class="string">&#x27;Gender&#x27;</span>:gender,<span class="string">&#x27;Age&#x27;</span>:age,<span class="string">&#x27;Score&#x27;</span>:score&#125;)</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;使用 agg 函数:&#x27;</span>)</span><br><span class="line">print(df.agg(&#123;<span class="string">&#x27;Age&#x27;</span>:[<span class="string">&#x27;sum&#x27;</span>,<span class="string">&#x27;mean&#x27;</span>],<span class="string">&#x27;Score&#x27;</span>:[<span class="string">&#x27;sum&#x27;</span>,<span class="string">&#x27;mean&#x27;</span>]&#125;))</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们也可以使用自定义的 lambda 函数:&#x27;</span>)</span><br><span class="line">get_max = <span class="keyword">lambda</span> x: x.sort_values(ascending=<span class="literal">False</span>).iloc[<span class="number">0</span>]</span><br><span class="line">get_max.__name__ = <span class="string">&#x27;get_max&#x27;</span></span><br><span class="line">print(df.agg(&#123;<span class="string">&#x27;Age&#x27;</span>:[get_max],<span class="string">&#x27;Score&#x27;</span>:[get_max]&#125;))</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">我们的数据是:</span><br><span class="line">      Name  Gender  Age  Score</span><br><span class="line">0     Alen    Male   18     80</span><br><span class="line">1      Bob    Male   19     90</span><br><span class="line">2     Cidy  Female   18     93</span><br><span class="line">3   Daniel    Male   20     87</span><br><span class="line">4    Ellen  Female   17     96</span><br><span class="line">5  Frankie    Male   21    100</span><br><span class="line">6     Gate    Male   20     88</span><br><span class="line">7     Hebe  Female   22     98</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用 agg 函数:</span><br><span class="line">          Age  Score</span><br><span class="line">sum   155.000  732.0</span><br><span class="line">mean   19.375   91.5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">我们也可以使用自定义的 lambda 函数:</span><br><span class="line">         Age  Score</span><br><span class="line">get_max   22    100</span><br></pre></td></tr></table></figure>
<h4 id="5-7-3-DataFrame-transform"><a href="#5-7-3-DataFrame-transform" class="headerlink" title="5.7.3 DataFrame.transform()"></a>5.7.3 DataFrame.transform()</h4><p>调用<code>func</code>自己产生一个改变值的和自己的相同的轴长度的<code>DataFrame</code>. </p>
<p>直接看例子:</p>
<p>假设我们有下面的<a target="_blank" rel="noopener" href="https://github.com/chris1610/pbpython/blob/master/data/sales_transactions.xlsx?raw=true">销售数据</a>, 有三个不同的 <strong>订单id</strong>  (10001, 10005和10006), 每个 订单id又含有多个产品.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;sales_transactions.xlsx&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;我们的数据是:&#x27;</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<p><img src="https://i.loli.net/2020/08/21/PkKfqbH9TBmvGtl.png" alt="image-20200821153859613" style="zoom:50%;" /></p>
<p><strong>我们现在要求解的问题是: 每个订单中各个单品费用分布及占比</strong>. <strong>例如订单10001总价$576.12，细分一下:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">B1-20000 &#x3D; $235.83 or 40.9%</span><br><span class="line">S1-27722 &#x3D; $232.32 or 40.3%</span><br><span class="line">B1-86481 &#x3D; $107.97 or 18.7%</span><br></pre></td></tr></table></figure>
<p><strong>解决这个问题用两种方式:</strong></p>
<p>第一种新建 DataFrame 然后 merge 两个 DataFrame. 代码如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">order_total = df.groupby(<span class="string">&#x27;order&#x27;</span>)[<span class="string">&quot;ext price&quot;</span>].<span class="built_in">sum</span>().rename(<span class="string">&quot;Order_Total&quot;</span>).reset_index()</span><br><span class="line"></span><br><span class="line">df_1 = df.merge(order_total)</span><br><span class="line">df_1[<span class="string">&quot;Percent_of_Order&quot;</span>] = df_1[<span class="string">&quot;ext price&quot;</span>] / df_1[<span class="string">&quot;Order_Total&quot;</span>]</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;新建的 DataFrame 是:&#x27;</span>)</span><br><span class="line">print(order_total)</span><br><span class="line">print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&#x27;我们的结果是:&#x27;</span>)</span><br><span class="line">print(df_1)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<blockquote>
<p>  <strong>新建的 DataFrame 是:</strong></p>
<p>  <img src="https://i.loli.net/2020/08/21/py6zmaZlnShGP7U.png" alt="image-20200821163934164" style="zoom:50%;" /></p>
<p>  <strong>我们的结果是:</strong></p>
<p>  <img src="https://i.loli.net/2020/08/21/wThdLUcA9VDusrq.png" alt="image-20200821163951790" style="zoom:50%;" /></p>
</blockquote>
<p>第二种就是使用 <code>DataFrame.transform()</code> 这个函数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;sales_transactions.xlsx&#x27;</span>)</span><br><span class="line"></span><br><span class="line">df[<span class="string">&quot;Percent_of_Order&quot;</span>] = df[<span class="string">&quot;ext price&quot;</span>] / df.groupby(<span class="string">&#x27;order&#x27;</span>)[<span class="string">&quot;ext price&quot;</span>].transform(<span class="string">&#x27;sum&#x27;</span>)</span><br><span class="line">print(<span class="string">&#x27;我们的结果是:&#x27;</span>)</span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>
<p>输出结果是:</p>
<blockquote>
<p>  <strong>我们的结果是:</strong></p>
<p>  <img src="https://i.loli.net/2020/08/21/glw2KidqnrxBJES.png" alt="image-20200821164332003" style="zoom:50%;" /></p>
</blockquote>
<h2 id="Topic-6-Pandas-IO"><a href="#Topic-6-Pandas-IO" class="headerlink" title="Topic 6 Pandas IO"></a>Topic 6 Pandas IO</h2><p>平时工作中, 我们会接触到不同的数据文件, 比如很常见的excel文件(后缀名为xls和xlsx), csv、txt等文本文件, json文件以及sql文件等等. pandas读取这些数据文件的方法如表格所示:</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>读取方法</th>
<th>描述</th>
<th>写入方法</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>read_csv</code></td>
<td>读取 csv 文件, 逗号是默认分隔符</td>
<td><code>to_csv</code></td>
</tr>
<tr>
<td><code>read_table</code></td>
<td>读取通用分隔符分割的数据文件, 默认为制表符 <code>\t</code></td>
<td><code>to_csv</code></td>
</tr>
<tr>
<td><code>read_excel</code></td>
<td>读取 <code>xls</code> 或者 <code>xlsx</code> 表格文件</td>
<td><code>to_excel</code></td>
</tr>
<tr>
<td><code>read_json</code></td>
<td>读取 <code>json</code> 文件</td>
<td><code>to_json</code></td>
</tr>
<tr>
<td><code>read_sql</code></td>
<td>从 SQL 请求读取或者读取数据库中的表</td>
<td><code>to_sql</code></td>
</tr>
<tr>
<td><code>read_sql_table</code></td>
<td>读取数据库中的表</td>
<td><code>to_sql</code></td>
</tr>
<tr>
<td><code>read_sql_query</code></td>
<td>从 SQL 请求读取数据</td>
<td><code>to_sql</code></td>
</tr>
</tbody>
</table>
</div>
<h3 id="6-1-pandas-read-csv"><a href="#6-1-pandas-read-csv" class="headerlink" title="6.1 pandas.read_csv()"></a>6.1 pandas.read_csv()</h3><p><strong>read_csv()方法用来读取 csv格式的数据文件, read_table()方法则是读取通用分隔符分隔的数据文件</strong>, 它们的参数相同, 语法如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pandas.read_csv(filepath_or_buffer, sep=<span class="string">&#x27;,&#x27;</span>, delimiter=<span class="literal">None</span>, header=<span class="string">&#x27;infer&#x27;</span>, names=<span class="literal">None</span>, index_col=<span class="literal">None</span>, usecols=<span class="literal">None</span>, skiprows=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数说明</span></span><br><span class="line"><span class="comment"># filepath_or_buffer: str, 表示文件所在位置的字符串, URL等.</span></span><br><span class="line"><span class="comment"># sep: str, 表示分隔符, 分隔符号可以有多个, 比如分隔符为&quot;+,+&quot;三个符号, 则sep = &#x27;+,+&#x27;, 即正则表达式. read_csv默认分隔符为&quot;,&quot;, read_table默认为制表符&quot;\t&quot;</span></span><br><span class="line"><span class="comment"># delimitter: sep的别名</span></span><br><span class="line"><span class="comment"># header: int, 表示列名的行号. 如果没有传递列名, 则header = 0, 列名为文件的第一行. 如果显式传递了列名, 则header = None</span></span><br><span class="line"><span class="comment"># names: 指定列名</span></span><br><span class="line"><span class="comment"># index_col: int,sequence或False. 表示索引列的位置, 取值为sequence则代表多重索引</span></span><br><span class="line"><span class="comment"># usecols: array, 指定读取的列</span></span><br><span class="line"><span class="comment"># skiprows: 从文件开头算, 需要跳过的行数</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">阿平</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.facequant.com/2020/08/18/Introduction-to-Pandas/">https://www.facequant.com/2020/08/18/Introduction-to-Pandas/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.facequant.com" target="_blank">阿平的自我修养</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Data/">Data</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/08/09/2sYXwjC1ZRBKmpl.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/11/12/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%9A%84-Notation/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/alvisdeng/ImgHouse@main/cmu.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">机器学习中常用的 Notation</div></div></a></div><div class="next-post pull-right"><a href="/2020/08/18/Introduction-to-Numpy/"><img class="next-cover" src="https://i.loli.net/2020/08/09/2sYXwjC1ZRBKmpl.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Introduction to Numpy</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/08/18/Introduction-to-Numpy/" title="Introduction to Numpy"><img class="cover" src="https://i.loli.net/2020/08/09/2sYXwjC1ZRBKmpl.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-08-18</div><div class="title">Introduction to Numpy</div></div></a></div></div></div></div><div class="aside_content" id="aside_content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Topic-1-Data-Structure"><span class="toc-text">Topic 1 Data Structure</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-Overview"><span class="toc-text">1.1 Overview</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-Series"><span class="toc-text">1.2 Series</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-DataFrame"><span class="toc-text">1.3 DataFrame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4-Panel"><span class="toc-text">1.4 Panel</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Topic-2-Series"><span class="toc-text">Topic 2 Series</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Series-Creation"><span class="toc-text">2.1 Series Creation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Reading-Series"><span class="toc-text">2.2 Reading Series</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Properties-of-Series"><span class="toc-text">2.3 Properties of Series</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-Series-axes"><span class="toc-text">2.3.1 Series.axes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-Series-empty"><span class="toc-text">2.3.2 Series.empty</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-3-Series-ndim"><span class="toc-text">2.3.3 Series.ndim</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-Series-size"><span class="toc-text">2.3.4 Series.size</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-5-Series-values"><span class="toc-text">2.3.5 Series.values</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Topic-3-DataFrame"><span class="toc-text">Topic 3 DataFrame</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-DataFrame-Creation"><span class="toc-text">3.1 DataFrame Creation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-DataFrame-Operations"><span class="toc-text">3.2 DataFrame Operations</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-Reading-Data-from-Columns"><span class="toc-text">3.2.1 Reading Data from Columns</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-Reading-Data-from-Rows"><span class="toc-text">3.2.2 Reading Data from Rows</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-Adding-and-Deleting-Columns"><span class="toc-text">3.2.3 Adding and Deleting Columns</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-4-Adding-and-Deleting-Rows"><span class="toc-text">3.2.4 Adding and Deleting Rows</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-5-Reindexing-and-Renaming"><span class="toc-text">3.2.5 Reindexing and Renaming</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-Properties-of-DataFrame"><span class="toc-text">3.3 Properties of DataFrame</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-1-DataFrame-T"><span class="toc-text">3.3.1 DataFrame.T</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-2-DataFrame-axes"><span class="toc-text">3.3.2 DataFrame.axes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-3-DataFrame-dtypes"><span class="toc-text">3.3.3 DataFrame.dtypes</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-DataFrame-MultiIndex"><span class="toc-text">3.4 DataFrame MultiIndex</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-1-MultiIndex-Creation"><span class="toc-text">3.4.1 MultiIndex Creation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-2-Use-of-MultiIndex"><span class="toc-text">3.4.2 Use of MultiIndex</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5-DataFrame-Iteration"><span class="toc-text">3.5 DataFrame Iteration</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-1-DataFrame-iteritems"><span class="toc-text">3.5.1 DataFrame.iteritems()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-2-DataFrame-iterrows"><span class="toc-text">3.5.2 DataFrame.iterrows()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-3-DataFrame-itertuples"><span class="toc-text">3.5.3 DataFrame.itertuples()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-6-Sorting-DataFrame"><span class="toc-text">3.6 Sorting DataFrame</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-1-DataFrame-sort-index"><span class="toc-text">3.6.1 DataFrame.sort_index()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-2-DataFrame-sort-values"><span class="toc-text">3.6.2 DataFrame.sort_values()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-7-Date-Function"><span class="toc-text">3.7 Date Function</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-1-pandas-date-range"><span class="toc-text">3.7.1 pandas.date_range()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-2-pandas-bdate-range"><span class="toc-text">3.7.2 pandas.bdate_range()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-7-3-pandas-Timedelta"><span class="toc-text">3.7.3 pandas.Timedelta()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-8-Categorical-Data"><span class="toc-text">3.8 Categorical Data</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8-1-Object-Creation"><span class="toc-text">3.8.1 Object Creation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8-2-Reading-Categorical-Data"><span class="toc-text">3.8.2 Reading Categorical Data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-8-3-Categorical-Data-Operations"><span class="toc-text">3.8.3 Categorical Data Operations</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Topic-4-Statistics-Functions"><span class="toc-text">Topic 4 Statistics Functions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-DataFrame-count"><span class="toc-text">4.1 DataFrame.count()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-DataFrame-sum"><span class="toc-text">4.2 DataFrame.sum()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-DataFrame-mean"><span class="toc-text">4.3 DataFrame.mean()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-DataFrame-mode"><span class="toc-text">4.4 DataFrame.mode()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-DataFrame-abs"><span class="toc-text">4.5 DataFrame.abs()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-DataFrame-cumsum-amp-DataFrame-cumprod"><span class="toc-text">4.6 DataFrame.cumsum() &amp; DataFrame.cumprod()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-7-DataFrame-describe"><span class="toc-text">4.7 DataFrame.describe()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8-DataFrame-pct-change"><span class="toc-text">4.8 DataFrame.pct_change()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-9-DataFrame-sample"><span class="toc-text">4.9 DataFrame.sample()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Topic-5-Data-Cleaning"><span class="toc-text">Topic 5 Data Cleaning</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-Deleting-NaN-Data"><span class="toc-text">5.1 Deleting NaN Data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-Filling-NaN-Data"><span class="toc-text">5.2 Filling NaN Data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-Deleting-Duplicated-Data"><span class="toc-text">5.3 Deleting Duplicated Data</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-Transform-Data"><span class="toc-text">5.4 Transform Data</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-1-Series-map"><span class="toc-text">5.4.1 Series.map()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-2-DataFrame-replace"><span class="toc-text">5.4.2 DataFrame.replace()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-3-DataFrame-apply"><span class="toc-text">5.4.3 DataFrame.apply()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-4-5-DataFrame-applymap"><span class="toc-text">5.4.5 DataFrame.applymap()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-5-Data-Concatenation"><span class="toc-text">5.5 Data Concatenation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-1-pandas-concat"><span class="toc-text">5.5.1 pandas.concat()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-5-2-pandas-merge"><span class="toc-text">5.5.2 pandas.merge()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-6-Reforming-Data"><span class="toc-text">5.6 Reforming Data</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-1-DataFrame-pivot"><span class="toc-text">5.6.1 DataFrame.pivot()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-6-2-DataFrame-pivot-table"><span class="toc-text">5.6.2 DataFrame.pivot_table()</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-7-Aggregating-Data"><span class="toc-text">5.7 Aggregating Data</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-7-1-DataFrame-groupby"><span class="toc-text">5.7.1 DataFrame.groupby()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-7-2-DataFrame-agg"><span class="toc-text">5.7.2 DataFrame.agg()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-7-3-DataFrame-transform"><span class="toc-text">5.7.3 DataFrame.transform()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Topic-6-Pandas-IO"><span class="toc-text">Topic 6 Pandas IO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-pandas-read-csv"><span class="toc-text">6.1 pandas.read_csv()</span></a></li></ol></li></ol></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 By 阿平</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.spacingElementById('content-inner')
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.spacingElementById('content-inner')
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>